params {
    reads = "path/to/reads/*.fastq.gz"
    outdir = "results"
    hisat2_index = "path/to/hisat2/index"
    splice_sites = "path/to/splice_sites.txt"
}

process {
    publishDir = [
        path: { "${params.outdir}/${task.process.tokenize(':')[-1].toLowerCase()}" },
        mode: 'copy',
        saveAs: { filename -> filename.equals('versions.yml') ? null : filename }
    ]
}

profiles {
    conda {
        conda.enabled = true
        process {
            withName: 'FASTQC.*' { conda = "bioconda::fastqc=0.11.9" }
            withName: 'TRIM_GALORE' { conda = "bioconda::trim-galore=0.6.7" }
            withName: 'HISAT2_ALIGN' { conda = "bioconda::hisat2=2.2.1 bioconda::samtools=1.15.1" }
            withName: 'MULTIQC.*' { conda = "bioconda::multiqc=1.13" }
        }
    }
}

// Capture exit codes from upstream processes when piping
process.shell = ['/bin/bash', '-euo', 'pipefail']

// Capture Nextflow log files
timeline {
    enabled = true
    file = "${params.outdir}/pipeline_info/execution_timeline.html"
}
report {
    enabled = true
    file = "${params.outdir}/pipeline_info/execution_report.html"
}
trace {
    enabled = true
    file = "${params.outdir}/pipeline_info/execution_trace.txt"
}
dag {
    enabled = true
    file = "${params.outdir}/pipeline_info/pipeline_dag.svg"
}
