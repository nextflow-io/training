
<!doctype html>
<html lang="ko" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://training.nextflow.io/0.dev/ko/nf4_science/genomics/04_testing/">
      
      
        <link rel="prev" href="../03_modules/">
      
      
        <link rel="next" href="../survey/">
      
      
      <link rel="icon" href="../../../../assets/img/nextflow-icon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Part 4: Adding tests - training.nextflow.io</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Inter";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/fonts.css">
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-244N3GEN75"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-244N3GEN75",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-244N3GEN75",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>if("undefined"!=typeof __md_analytics){var consent=__md_get("__consent");consent&&consent.analytics&&__md_analytics()}</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#part-4-adding-tests" class="md-skip">
          콘텐츠로 이동
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-banner">
          <div class="md-banner__inner md-grid md-typeset">
            
            
<div style="text-align: center">
  Nextflow Training Week (2025-Q1):
  <strong>March 10-14, 2025</strong>
  <a
    class="md-button"
    href="https://community.seqera.io/t/nextflow-training-week-2025-q1/1775/6"
    target="_blank"
  >
    More info
    <span class="twemoji"
      ><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
        <path
          d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"
        ></path></svg
    ></span>
  </a>
</div>
<style type="text/css">
  .md-banner {
    display: none;
  }
</style>

<script>
  (function () {
    function hideAnnouncement() {
      var announcementDate = new Date(
        "2025-03-15T00:00:00Z",
      );
      var currentDate = new Date();
      var banner = document.querySelector(".md-banner");
      if (banner && currentDate <= announcementDate) {
        banner.style.display = "block";
      }
    }

    // Run on initial load
    hideAnnouncement();

    // Hook into XHR to run after each page update
    var originalOpen = XMLHttpRequest.prototype.open;
    XMLHttpRequest.prototype.open = function () {
      this.addEventListener("load", function () {
        setTimeout(hideAnnouncement, 0); // Ensure it runs after the request completes
      });
      return originalOpen.apply(this, arguments);
    };
  })();
</script>
 
          </div>
          
        </aside>
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="상단/헤더">
    <a href="../../../" title="training.nextflow.io" class="md-header__button md-logo" aria-label="training.nextflow.io" data-md-component="logo">
      
  <img src="../../../../assets/img/nextflow_logo_dark.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            training.nextflow.io
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Part 4: Adding tests
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="언어설정">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="../../../../nf4_science/genomics/04_testing/" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../../../pt/nf4_science/genomics/04_testing/" hreflang="pt" class="md-select__link">
              Português
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../../../es/nf4_science/genomics/04_testing/" hreflang="es" class="md-select__link">
              Español
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../../../fr/nf4_science/genomics/04_testing/" hreflang="fr" class="md-select__link">
              Français
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../../../it/nf4_science/genomics/04_testing/" hreflang="it" class="md-select__link">
              Italiano
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="./" hreflang="ko" class="md-select__link">
              Korean
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="검색" placeholder="검색" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="검색">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="공유" aria-label="공유" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="지우기" aria-label="지우기" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            검색 초기화
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/nextflow-io/training" title="저장소로 이동" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    nextflow-io/training
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="네비게이션" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../" title="training.nextflow.io" class="md-nav__button md-logo" aria-label="training.nextflow.io" data-md-component="logo">
      
  <img src="../../../../assets/img/nextflow_logo_dark.png" alt="logo">

    </a>
    training.nextflow.io
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/nextflow-io/training" title="저장소로 이동" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    nextflow-io/training
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Environment setup
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Environment setup
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../envsetup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    환경 설정
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../envsetup/01_setup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    GitHub Codespaces
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../envsetup/02_local/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    로컬 설치
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../envsetup/03_devcontainer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Local installation using VSCode Devcontainers extension
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Hello Nextflow
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Hello Nextflow
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../hello_nextflow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Hello Nextflow
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../hello_nextflow/00_orientation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Orientation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../hello_nextflow/01_hello_world/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Part 1: Hello World
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../hello_nextflow/02_hello_channels/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Part 2: Hello Channels
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../hello_nextflow/03_hello_workflow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Part 3: Hello Workflow
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../hello_nextflow/04_hello_modules/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Part 4: Hello Modules
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../hello_nextflow/05_hello_containers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Part 5: Hello Containers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../hello_nextflow/06_hello_config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Part 6: Hello Config
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../hello_nextflow/survey/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Feedback survey
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../hello_nextflow/next_steps/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Next Steps
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Hello nf-core
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Hello nf-core
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../hello_nf-core/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Hello nf-core
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../hello_nf-core/00_orientation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Orientation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../hello_nf-core/01_run_demo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Part 1: Run a demo pipeline
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../hello_nf-core/02_rewrite_hello/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Part 2: Rewrite Hello for nf-core
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../hello_nf-core/survey/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Feedback survey
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../hello_nf-core/next_steps/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Next Steps
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Nextflow for Genomics
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Nextflow for Genomics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Nextflow for Genomics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../00_orientation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Orientation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01_per_sample_variant_calling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Part 1: Per-sample variant calling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02_joint_calling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Part 2: Joint calling on a cohort
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../03_modules/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Part 3: Moving code into modules
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Part 4: Adding tests
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Part 4: Adding tests
    
  </span>
  

      </a>
      
          

<nav class="md-nav md-nav--secondary" aria-label="On this page">
       
  <label class="md-nav__title" for="__toc">
    <span class="md-nav__icon md-icon"></span>
    On this page
  </label>
  <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
     <li class="md-nav__item">
  <a href="#0-warmup" class="md-nav__link">
    <span class="md-ellipsis">
      0. Warmup
    </span>
  </a>
  
    <nav class="md-nav" aria-label="0. Warmup">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#01-check-the-workflow-runs" class="md-nav__link">
    <span class="md-ellipsis">
      0.1. Check the workflow runs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#02-initialize-nf-test" class="md-nav__link">
    <span class="md-ellipsis">
      0.2. Initialize nf-test
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#takeaway" class="md-nav__link">
    <span class="md-ellipsis">
      Takeaway
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whats-next" class="md-nav__link">
    <span class="md-ellipsis">
      What's next?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>  <li class="md-nav__item">
  <a href="#1-test-a-process-for-success-and-matching-outputs" class="md-nav__link">
    <span class="md-ellipsis">
      1. Test a process for success and matching outputs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. Test a process for success and matching outputs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11-generate-a-test-file-stub" class="md-nav__link">
    <span class="md-ellipsis">
      1.1. Generate a test file stub
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-move-the-test-file-and-update-the-script-path" class="md-nav__link">
    <span class="md-ellipsis">
      1.2. Move the test file and update the script path
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13-provide-test-inputs-for-samtools_index" class="md-nav__link">
    <span class="md-ellipsis">
      1.3. Provide test inputs for SAMTOOLS_INDEX
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#14-name-the-test-based-on-functionality" class="md-nav__link">
    <span class="md-ellipsis">
      1.4. Name the test based on functionality
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#15-specify-test-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      1.5. Specify test parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#16-run-the-test-and-examine-the-output" class="md-nav__link">
    <span class="md-ellipsis">
      1.6. Run the test and examine the output
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#17-add-more-tests-to-samtools_index" class="md-nav__link">
    <span class="md-ellipsis">
      1.7. Add more tests to SAMTOOLS_INDEX
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#takeaway_1" class="md-nav__link">
    <span class="md-ellipsis">
      Takeaway
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whats-next_1" class="md-nav__link">
    <span class="md-ellipsis">
      What's next?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>  <li class="md-nav__item">
  <a href="#2-add-tests-to-a-chained-process-and-test-for-contents" class="md-nav__link">
    <span class="md-ellipsis">
      2. Add tests to a chained process and test for contents
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Add tests to a chained process and test for contents">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-generate-and-place-the-test-file" class="md-nav__link">
    <span class="md-ellipsis">
      2.1. Generate and place the test file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-move-the-test-file-and-update-the-script-path" class="md-nav__link">
    <span class="md-ellipsis">
      2.2. Move the test file and update the script path
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-provide-inputs-using-the-setup-method" class="md-nav__link">
    <span class="md-ellipsis">
      2.3. Provide inputs using the setup method
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24-run-again-and-observe-failure" class="md-nav__link">
    <span class="md-ellipsis">
      2.4. Run again and observe failure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#25-use-a-content-assertion-method-to-check-a-specific-variant" class="md-nav__link">
    <span class="md-ellipsis">
      2.5. Use a content assertion method to check a specific variant
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#26-run-again-and-observe-success" class="md-nav__link">
    <span class="md-ellipsis">
      2.6. Run again and observe success
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#27-add-more-tests" class="md-nav__link">
    <span class="md-ellipsis">
      2.7. Add more tests
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#28-run-the-test-command" class="md-nav__link">
    <span class="md-ellipsis">
      2.8. Run the test command
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#takeaway_2" class="md-nav__link">
    <span class="md-ellipsis">
      Takeaway
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whats-next_2" class="md-nav__link">
    <span class="md-ellipsis">
      What's next?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>  <li class="md-nav__item">
  <a href="#3-use-pre-generated-test-data" class="md-nav__link">
    <span class="md-ellipsis">
      3. Use pre-generated test data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Use pre-generated test data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-generate-test-data" class="md-nav__link">
    <span class="md-ellipsis">
      3.1. Generate test data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-generate-the-test-file-stub" class="md-nav__link">
    <span class="md-ellipsis">
      3.2. Generate the test file stub
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-move-the-test-file-and-update-the-script-path" class="md-nav__link">
    <span class="md-ellipsis">
      3.3. Move the test file and update the script path
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-provide-inputs" class="md-nav__link">
    <span class="md-ellipsis">
      3.4. Provide inputs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#35-use-content-assertions" class="md-nav__link">
    <span class="md-ellipsis">
      3.5. Use content assertions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#36-run-the-test" class="md-nav__link">
    <span class="md-ellipsis">
      3.6. Run the test
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#takeaway_3" class="md-nav__link">
    <span class="md-ellipsis">
      Takeaway
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whats-next_3" class="md-nav__link">
    <span class="md-ellipsis">
      What's next?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>  <li class="md-nav__item">
  <a href="#4-add-a-workflow-level-test" class="md-nav__link">
    <span class="md-ellipsis">
      4. Add a workflow-level test
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Add a workflow-level test">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-generate-the-workflow-test" class="md-nav__link">
    <span class="md-ellipsis">
      4.1. Generate the workflow test
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-specify-input-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      4.2. Specify input parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-run-the-workflow-test" class="md-nav__link">
    <span class="md-ellipsis">
      4.3. Run the workflow test
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#44-run-all-tests" class="md-nav__link">
    <span class="md-ellipsis">
      4.4. Run ALL tests
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>  <li class="md-nav__item">
  <a href="#takeaway_4" class="md-nav__link">
    <span class="md-ellipsis">
      Takeaway
    </span>
  </a>
  
</li> 
  </ul>
  
</nav>
<nav class="md-nav md-nav--secondary sidebar_resources" aria-label="Resources">
  <label class="md-nav__title">Resources</label>
  <ul class="md-nav__list">
    <li class="md-nav__item">
      <a
        href="https://nextflow.io/docs/latest/index.html"
        target="_blank"
        rel="noopener"
        class="md-nav__link"
      >
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
          <path
            d="M17.5 14.33c.79 0 1.63.08 2.5.24v1.5c-.62-.16-1.46-.24-2.5-.24-1.9 0-3.39.33-4.5.99v-1.69c1.17-.53 2.67-.8 4.5-.8M13 12.46c1.29-.53 2.79-.79 4.5-.79.79 0 1.63.07 2.5.23v1.5c-.62-.16-1.46-.24-2.5-.24-1.9 0-3.39.34-4.5.99m4.5-3.65c-1.9 0-3.39.32-4.5 1V9.84c1.23-.56 2.73-.84 4.5-.84.79 0 1.63.08 2.5.23v1.55c-.74-.19-1.59-.28-2.5-.28m3.5 8V7c-1.04-.33-2.21-.5-3.5-.5-2.05 0-3.88.5-5.5 1.5v11.5c1.62-1 3.45-1.5 5.5-1.5 1.19 0 2.36.16 3.5.5m-3.5-14c2.35 0 4.19.5 5.5 1.5v14.56c0 .12-.05.24-.16.35-.11.09-.23.17-.34.17-.11 0-.19-.02-.25-.05-1.28-.69-2.87-1.03-4.75-1.03-2.05 0-3.88.5-5.5 1.5-1.34-1-3.17-1.5-5.5-1.5-1.66 0-3.25.36-4.75 1.07-.03.01-.07.01-.12.03-.04.01-.08.02-.13.02-.11 0-.23-.04-.34-.12a.475.475 0 0 1-.16-.35V6c1.34-1 3.18-1.5 5.5-1.5 2.33 0 4.16.5 5.5 1.5 1.34-1 3.17-1.5 5.5-1.5Z"
          ></path>
        </svg>
        Nextflow Docs
      </a>
    </li>
    <li class="md-nav__item">
      <a
        href="https://www.nextflow.io/slack-invite.html"
        target="_blank"
        rel="noopener"
        class="md-nav__link"
      >
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
          <path
            d="M6 15a2 2 0 0 1-2 2 2 2 0 0 1-2-2 2 2 0 0 1 2-2h2v2m1 0a2 2 0 0 1 2-2 2 2 0 0 1 2 2v5a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-5m2-8a2 2 0 0 1-2-2 2 2 0 0 1 2-2 2 2 0 0 1 2 2v2H9m0 1a2 2 0 0 1 2 2 2 2 0 0 1-2 2H4a2 2 0 0 1-2-2 2 2 0 0 1 2-2h5m8 2a2 2 0 0 1 2-2 2 2 0 0 1 2 2 2 2 0 0 1-2 2h-2v-2m-1 0a2 2 0 0 1-2 2 2 2 0 0 1-2-2V5a2 2 0 0 1 2-2 2 2 0 0 1 2 2v5m-2 8a2 2 0 0 1 2 2 2 2 0 0 1-2 2 2 2 0 0 1-2-2v-2h2m0-1a2 2 0 0 1-2-2 2 2 0 0 1 2-2h5a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-5Z"
          ></path>
        </svg>
        Nextflow Slack
      </a>
    </li>
    <li class="md-nav__item">
      <a
        href="https://nextflow.io/"
        target="_blank"
        rel="noopener"
        class="md-nav__link"
      >
        <svg
          version="1.1"
          id="Layer_1"
          xmlns="http://www.w3.org/2000/svg"
          viewBox="80 50 350 350"
        >
          <style type="text/css">
            .st0 {
              fill: "gray";
            }
          </style>
          <path
            class="st0"
            d="M124.5,171.5c39.4,2.6,71.1,34.3,73.5,73.8h46.1c-2.6-65-54.7-117.2-119.6-119.9V171.5z"
          />
          <path
            class="st0"
            d="M198.3,255.8c-2.6,39.5-34.3,71.1-73.8,73.5v46.1c65-2.6,117.2-54.7,119.9-119.6H198.3z"
          />
          <path
            class="st0"
            d="M300.7,245c2.6-39.5,34.3-71.1,73.8-73.5v-46.1c-65,2.6-117.2,54.7-119.9,119.6H300.7z"
          />
          <path
            class="st0"
            d="M374.5,329.3c-39.4-2.6-71.1-34.3-73.5-73.8h-46.1c2.6,65,54.7,117.2,119.6,119.9V329.3z"
          />
        </svg>
        Nextflow Homepage
      </a>
    </li>
    <li class="md-nav__item">
      <a
        href="https://seqera.io/"
        target="_blank"
        rel="noopener"
        class="md-nav__link"
      >
        <?xml version="1.0" encoding="utf-8"?>
        <!-- Generator: Adobe Illustrator 28.3.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->
        <svg
          version="1.1"
          id="Layer_1"
          xmlns="http://www.w3.org/2000/svg"
          xmlns:xlink="http://www.w3.org/1999/xlink"
          x="0px"
          y="0px"
          viewBox="80 50 350 350"
          style="enable-background: new 0 0 500 500"
          xml:space="preserve"
        >
          <style type="text/css">
            .st0 {
              clip-path: url(#SVGID_00000006699037935518914080000000086571810102047141_);
            }
            .st1 {
              fill: "gray";
            }
          </style>
          <g>
            <defs>
              <rect id="SVGID_1_" x="125" y="125" width="250" height="250" />
            </defs>
            <clipPath
              id="SVGID_00000183214694142566821210000012389151436317298101_"
            >
              <use xlink:href="#SVGID_1_" style="overflow: visible" />
            </clipPath>
            <g
              style="
                clip-path: url(#SVGID_00000183214694142566821210000012389151436317298101_);
              "
            >
              <path
                class="st1"
                d="M375,333l-0.1-0.9l-0.1-0.8l-0.1-0.9l-0.1-0.9l-0.1-0.8l-0.1-0.9l-0.1-0.8l-0.2-0.9l-0.2-0.8l-0.2-0.8
                      l-0.2-0.8l-0.2-0.8l-0.2-0.8l-0.3-0.8l-0.3-0.8l-0.3-0.8l-0.3-0.8l-0.4-0.8l-0.4-0.8l-0.4-0.8l-0.4-0.8l-0.4-0.8l-0.4-0.8
                      l-0.4-0.7l-0.5-0.7l-0.5-0.7l-0.5-0.7l-0.5-0.7l-0.5-0.7l-0.5-0.7l-0.5-0.7L365,308l-0.6-0.6l-0.6-0.6l-0.6-0.6l-0.6-0.6L362,305
                      l-0.6-0.6l-0.7-0.6l-0.6-0.5l-1.2,0.7l-0.8,0.5l-0.8,0.4l-0.8,0.4l-0.8,0.4l-0.8,0.4l-0.9,0.4l-0.9,0.4l-0.9,0.3l-0.9,0.3
                      l-0.9,0.3l-0.9,0.3l-0.9,0.3l-0.9,0.3l-0.9,0.2l-0.9,0.2l-0.9,0.2l-0.9,0.2l-0.9,0.2l-0.9,0.1l-0.9,0.1l-0.9,0.1l-0.9,0.1
                      l-0.9,0.1l-0.9,0.1l-0.9,0.1l-0.9,0l-0.9,0h-57.5l59.7,16.4l0.4,0.1l0.4,0.1l0.4,0.1l0.3,0.2l0.3,0.2l0.3,0.2l0.3,0.2l0.3,0.2
                      l0.3,0.2l0.3,0.2l0.3,0.2l0.3,0.3l0.2,0.3l0.2,0.3l0.2,0.3l0.2,0.3l0.2,0.3l0.2,0.3l0.2,0.3l0.1,0.3l0.1,0.3l0.1,0.4l0.1,0.4
                      l0.1,0.4l0.1,0.4l0,0.4l0,0.4l0,0.4l0,0.4l0,0.4l0,0.4l-0.1,0.4l-0.1,0.4l-0.1,0.4l-0.1,0.3l-0.1,0.4l-0.1,0.3l-0.2,0.3l-0.2,0.3
                      l-0.2,0.3l-0.2,0.3l-0.2,0.3l-0.2,0.3l-0.2,0.3l-0.3,0.3l-0.3,0.3l-0.3,0.2l-0.3,0.2l-0.3,0.2l-0.3,0.2l-0.3,0.2l-0.3,0.2
                      l-0.3,0.1l-0.4,0.2l-0.4,0.1l-0.3,0.1l-0.4,0.1l-0.4,0.1l-0.4,0.1l-0.4,0l-0.4,0l-0.4,0H125V375h209.7l0.9,0l0.9,0l0.9,0l0.8-0.1
                      l0.9-0.1l0.8-0.1l0.9-0.1l0.8-0.1l0.8-0.1l0.8-0.2l0.8-0.2l0.8-0.2l0.8-0.2l0.8-0.2l0.8-0.3l0.8-0.3l0.8-0.3l0.8-0.3l0.8-0.3
                      l0.8-0.4l0.8-0.4l0.8-0.4l0.8-0.4l0.8-0.4l0.7-0.4l0.7-0.5l0.7-0.5l0.7-0.5l0.7-0.5l0.7-0.5l0.7-0.5l0.7-0.5l0.7-0.5l0.7-0.5
                      l0.6-0.6l0.6-0.6l0.6-0.6l0.6-0.6l0.6-0.6l0.6-0.6l0.6-0.7l0.5-0.7l0.5-0.7l0.5-0.7l0.5-0.7l0.5-0.7l0.5-0.7l0.5-0.7l0.4-0.7
                      l0.4-0.8l0.4-0.8l0.4-0.8l0.4-0.8l0.4-0.8l0.4-0.8l0.3-0.8l0.3-0.8l0.3-0.8l0.3-0.8l0.2-0.8l0.2-0.8l0.2-0.8l0.2-0.8l0.2-0.8
                      l0.2-0.8l0.1-0.8l0.1-0.9l0.1-0.9l0.1-0.8l0.1-0.9l0.1-0.9l0.1-0.8l0-0.9l0-0.9l0-0.8L375,333z"
              />
              <path
                class="st1"
                d="M375,260.4l-0.1-0.9l-0.1-0.9l-0.1-0.8l-0.1-0.9l-0.1-0.8l-0.1-0.8l-0.1-0.8l-0.2-0.8l-0.2-0.8l-0.2-0.8
                      l-0.2-0.8l-0.2-0.8l-0.2-0.8l-0.3-0.8l-0.3-0.8l-0.3-0.8l-0.3-0.8l-0.4-0.8l-0.4-0.8l-0.4-0.8l-0.4-0.8l-0.4-0.8l-0.4-0.7
                      l-0.4-0.7l-0.5-0.7l-0.5-0.7l-0.5-0.7l-0.5-0.7l-0.2-0.2h0h-89.8l59.7,16.4l0.4,0.1l0.4,0.1l0.4,0.1l0.3,0.2l0.3,0.2l0.3,0.2
                      l0.3,0.2l0.3,0.2l0.3,0.2l0.3,0.2l0.3,0.2l0.3,0.3l0.2,0.3l0.2,0.3l0.2,0.3l0.2,0.3l0.2,0.3l0.2,0.3l0.2,0.3l0.1,0.4l0.1,0.3
                      l0.1,0.4l0.1,0.4l0.1,0.4l0.1,0.4l0,0.4l0,0.4l0,0.4l0,0.4l0,0.4l0,0.4l-0.1,0.4l-0.1,0.4l-0.1,0.4l-0.1,0.4l-0.1,0.3l-0.1,0.4
                      l-0.2,0.4l-0.2,0.3l-0.2,0.3l-0.2,0.3l-0.2,0.3l-0.2,0.3l-0.2,0.3l-0.3,0.3l-0.3,0.3l-0.3,0.2l-0.3,0.2l-0.3,0.2l-0.3,0.2
                      l-0.3,0.2l-0.3,0.2l-0.3,0.2l-0.4,0.2l-0.4,0.1l-0.3,0.1l-0.4,0.1l-0.4,0.1l-0.4,0.1l-0.4,0l-0.4,0l-0.4,0h-82.5h-111H125v32.2
                      h122.8h86.9h0.9l0.9,0l0.9-0.1l0.8-0.1l0.9-0.1l0.8-0.1l0.9-0.1l0.8-0.1l0.8-0.2l0.8-0.2l0.8-0.2l0.8-0.2l0.8-0.2l0.8-0.2l0.8-0.3
                      l0.8-0.3l0.8-0.3l0.8-0.3l0.8-0.3l0.8-0.4l0.8-0.4l0.2-0.1l0.6-0.3l0.8-0.4l0.8-0.4l0.7-0.4l0.7-0.4l0.7-0.5l0.7-0.5l0.7-0.5
                      l0.7-0.5l0.7-0.5l0.7-0.5l0.7-0.5l0.7-0.6l0.6-0.6l0.6-0.6l0.6-0.6l0.6-0.6l0.6-0.6l0.6-0.6l0.6-0.6l0.5-0.7l0.5-0.7l0.5-0.7
                      l0.5-0.7l0.5-0.7l0.5-0.7l0.5-0.7l0.4-0.7l0.4-0.7l0.4-0.8l0.4-0.8l0.4-0.8l0.4-0.8l0.4-0.8l0.3-0.8l0.3-0.8l0.3-0.8l0.3-0.8
                      l0.2-0.8l0.2-0.8l0.2-0.8l0.2-0.8l0.2-0.8l0.2-0.8l0.1-0.8l0.1-0.9l0.1-0.8l0.1-0.9l0.1-0.8l0.1-0.9l0.1-0.9l0-0.8l0-0.9l0-0.9
                      L375,260.4z"
              />
              <path
                class="st1"
                d="M165.3,197.6l-0.9,0l-0.8,0l-0.9,0l-0.9,0.1l-0.8,0.1l-0.9,0.1l-0.8,0.1l-0.8,0.1l-0.8,0.2l-0.8,0.2l-0.8,0.2
                      l-0.8,0.2l-0.8,0.2l-0.8,0.2l-0.8,0.3l-0.8,0.3l-0.8,0.3l-0.8,0.3l-0.8,0.3l-0.8,0.4l-0.8,0.4l-0.2,0.1l-0.6,0.3l-0.8,0.4
                      l-0.8,0.4l-0.8,0.4l-0.7,0.4l-0.7,0.5l-0.7,0.5L142,205l-0.7,0.5l-0.7,0.5l-0.7,0.5l-0.7,0.5l-0.7,0.6l-0.6,0.6l-0.6,0.6l-0.6,0.6
                      l-0.6,0.6l-0.6,0.6l-0.6,0.6l-0.6,0.6l-0.5,0.6l-0.5,0.7l-0.5,0.7l-0.5,0.7l-0.5,0.7l-0.5,0.7l-0.4,0.7l-0.5,0.7l-0.4,0.7
                      l-0.4,0.8l-0.4,0.8l-0.4,0.8l-0.4,0.8l-0.3,0.8l-0.3,0.8l-0.3,0.8l-0.3,0.8l-0.3,0.8l-0.3,0.8l-0.2,0.8l-0.2,0.8l-0.2,0.8
                      l-0.2,0.8l-0.2,0.8l-0.2,0.8l-0.1,0.9l-0.1,0.9l-0.1,0.8l-0.1,0.9l-0.1,0.9l0,0.9l0,0.9v0.9v0.9l0,0.8l0,0.9l0.1,0.8l0.1,0.8
                      l0.1,0.9l0.1,0.9l0.1,0.8l0.2,0.9l0.2,0.8l0.2,0.8l0.2,0.8l0.2,0.8l0.2,0.8l0.3,0.8l0.3,0.8l0.3,0.8l0.3,0.8l0.3,0.8l0.3,0.8
                      l0.4,0.8l0.4,0.8l0.4,0.8l0.4,0.8l0.4,0.7l0.5,0.7l0.4,0.7l0.5,0.7l0.5,0.7l0.5,0.7l0.2,0.2h89.8l-59.7-16.4l-0.4-0.1l-0.3-0.1
                      l-0.4-0.1l-0.3-0.2l-0.3-0.2l-0.3-0.2l-0.3-0.2l-0.3-0.2l-0.3-0.2l-0.3-0.2l-0.3-0.2l-0.2-0.3l-0.2-0.3l-0.2-0.3l-0.2-0.3
                      l-0.2-0.3l-0.2-0.3l-0.2-0.3l-0.2-0.3l-0.1-0.4l-0.1-0.4l-0.1-0.3l-0.1-0.4l-0.1-0.4l-0.1-0.4l0-0.4l0-0.4l0-0.4l0-0.4l0-0.4
                      l0-0.4l0.1-0.4l0.1-0.4l0.1-0.4l0.1-0.4l0.1-0.4l0.1-0.3l0.2-0.3l0.2-0.3l0.2-0.3l0.2-0.3l0.2-0.3l0.2-0.3l0.2-0.3l0.2-0.3
                      l0.3-0.3l0.3-0.2l0.3-0.2l0.3-0.2l0.3-0.2l0.3-0.2l0.3-0.2l0.3-0.2l0.4-0.2l0.3-0.1l0.4-0.1l0.4-0.1l0.4-0.1l0.4-0.1l0.4,0l0.4,0
                      h0.4h82.5h111H375v-32.3H252.2H165.3z"
              />
              <path
                class="st1"
                d="M165.3,125l-0.9,0l-0.8,0l-0.9,0.1l-0.9,0.1l-0.8,0.1l-0.9,0.1l-0.8,0.1l-0.8,0.1l-0.8,0.2l-0.8,0.2l-0.8,0.2
                      l-0.8,0.2l-0.8,0.2l-0.8,0.2l-0.8,0.3l-0.8,0.3l-0.8,0.3l-0.8,0.3l-0.8,0.3l-0.8,0.3l-0.8,0.4l-0.8,0.4l-0.8,0.4l-0.8,0.4
                      l-0.8,0.4l-0.7,0.5l-0.7,0.4l-0.7,0.5l-0.7,0.5l-0.7,0.5l-0.7,0.5l-0.7,0.5l-0.7,0.6l-0.7,0.6l-0.6,0.6l-0.6,0.6l-0.6,0.6
                      l-0.6,0.6l-0.6,0.6l-0.6,0.6l-0.6,0.6l-0.5,0.7l-0.5,0.7l-0.5,0.7l-0.5,0.7l-0.5,0.7l-0.5,0.7l-0.4,0.7l-0.5,0.7l-0.4,0.7
                      l-0.4,0.8l-0.4,0.8l-0.4,0.8l-0.4,0.8l-0.3,0.8l-0.3,0.8l-0.3,0.8l-0.3,0.8l-0.3,0.8l-0.3,0.8l-0.2,0.8l-0.2,0.8l-0.2,0.8
                      l-0.2,0.8l-0.2,0.8l-0.2,0.8l-0.1,0.9l-0.1,0.8l-0.1,0.9l-0.1,0.8l-0.1,0.9l0,0.9l0,0.9v0.9v0.9l0,0.9l0,0.8l0.1,0.9l0.1,0.9
                      l0.1,0.8l0.1,0.8l0.1,0.8l0.2,0.8l0.2,0.8l0.2,0.8l0.2,0.8l0.2,0.8l0.2,0.8l0.3,0.8l0.3,0.8l0.3,0.8l0.3,0.8l0.3,0.8l0.3,0.8
                      l0.4,0.8l0.4,0.8l0.4,0.8l0.4,0.8l0.4,0.7l0.5,0.7l0.4,0.7l0.5,0.7l0.5,0.7l0.5,0.7l0.5,0.7l0.5,0.7l0.5,0.7l0.6,0.6l0.6,0.6
                      l0.6,0.6l0.6,0.6l0.6,0.6l0.6,0.6l0.6,0.6l0.7,0.6l0.6,0.5h0l1.1-0.7l0.8-0.5l0.8-0.5l0.8-0.4l0.8-0.4l0.9-0.4l0.9-0.4l0.9-0.4
                      l0.9-0.3l0.9-0.3l0.9-0.3l0.9-0.3l0.9-0.3l0.9-0.3l0.9-0.2l0.9-0.2l0.9-0.2l0.9-0.2l0.9-0.2l0.9-0.1l0.9-0.1l0.9-0.1l0.9-0.1
                      l0.9-0.1l0.9-0.1l0.9,0l0.9,0l0.9,0h57.5l-59.7-16.4l-0.4-0.1l-0.3-0.1l-0.4-0.1l-0.3-0.1l-0.3-0.2l-0.3-0.2l-0.3-0.2l-0.3-0.2
                      l-0.3-0.2l-0.3-0.2l-0.3-0.3l-0.2-0.3l-0.2-0.3l-0.2-0.3l-0.2-0.3l-0.2-0.3l-0.2-0.3l-0.2-0.3l-0.2-0.3l-0.1-0.3l-0.1-0.4
                      l-0.1-0.3l-0.1-0.4l-0.1-0.4l-0.1-0.4l0-0.4l0-0.4l0-0.4l0-0.4l0-0.4l0-0.4l0.1-0.4l0.1-0.4l0.1-0.4l0.1-0.4l0.1-0.4l0.1-0.3
                      l0.2-0.3l0.2-0.3l0.2-0.3l0.2-0.3l0.2-0.3l0.2-0.3l0.2-0.3l0.2-0.3l0.3-0.2l0.3-0.2l0.3-0.2l0.3-0.2l0.3-0.2l0.3-0.2l0.3-0.2
                      l0.3-0.2l0.4-0.1l0.3-0.1l0.4-0.1l0.4-0.1l0.4-0.1l0.4-0.1l0.4,0l0.4,0l0.4,0H375V125H165.3z"
              />
            </g>
          </g>
        </svg>
        Seqera
      </a>
    </li>
    <li class="md-nav__item">
      <a
        href="https://github.com/nextflow-io/training"
        target="_blank"
        rel="noopener"
        class="md-nav__link"
      >
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
          <path
            d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33.85 0 1.71.11 2.5.33 1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2Z"
          ></path>
        </svg>
        Training on GitHub
      </a>
    </li>
  </ul>
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../survey/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Feedback survey
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../next_steps/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Next Steps
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Nextflow for RNAseq
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Nextflow for RNAseq
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../rnaseq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Nextflow for RNAseq
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../rnaseq/00_orientation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Orientation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../rnaseq/01_method/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Part 1: Method overview and manual testing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../rnaseq/02_single-sample/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Part 2: Single-sample implementation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../rnaseq/03_multi-sample/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Part 3: Multi-sample paired-end implementation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../rnaseq/survey/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Feedback survey
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../rnaseq/next_steps/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Next Steps
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Side Quests
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Side Quests
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../side_quests/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Side Quests
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../side_quests/orientation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Orientation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../side_quests/workflows_of_workflows/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Workflows of Workflows
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../side_quests/splitting_and_grouping/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Splitting and Grouping
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../side_quests/nf-test/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Testing with nf-test
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../side_quests/nf-core/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction to nf-core
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Fundamentals Training
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Fundamentals Training
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic_training/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Fundamentals Training
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic_training/orientation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Orientation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic_training/intro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Basic concepts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic_training/rnaseq_pipeline/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Simple RNA-Seq workflow
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic_training/containers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Dependencies and containers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic_training/channels/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Channels
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic_training/processes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Processes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic_training/operators/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Operators
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic_training/groovy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Groovy introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic_training/modules/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Modularization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic_training/config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic_training/executors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Deployment scenarios
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic_training/seqera_platform/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Seqera Platform
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic_training/cache_and_resume/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cache and resume
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic_training/debugging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Troubleshooting
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Advanced Training
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Advanced Training
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../advanced/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Advanced Training
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../advanced/orientation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Orientation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../advanced/operators/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Operator Tour
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../advanced/metadata/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Metadata Propagation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../advanced/grouping/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Grouping and Splitting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../advanced/groovy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Groovy Imports
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../advanced/structure/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Workflow Structure
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../advanced/configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../advanced/summary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Summary
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../advanced/support/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Support
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../help/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Help
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                      

<nav class="md-nav md-nav--secondary" aria-label="On this page">
       
  <label class="md-nav__title" for="__toc">
    <span class="md-nav__icon md-icon"></span>
    On this page
  </label>
  <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
     <li class="md-nav__item">
  <a href="#0-warmup" class="md-nav__link">
    <span class="md-ellipsis">
      0. Warmup
    </span>
  </a>
  
    <nav class="md-nav" aria-label="0. Warmup">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#01-check-the-workflow-runs" class="md-nav__link">
    <span class="md-ellipsis">
      0.1. Check the workflow runs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#02-initialize-nf-test" class="md-nav__link">
    <span class="md-ellipsis">
      0.2. Initialize nf-test
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#takeaway" class="md-nav__link">
    <span class="md-ellipsis">
      Takeaway
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whats-next" class="md-nav__link">
    <span class="md-ellipsis">
      What's next?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>  <li class="md-nav__item">
  <a href="#1-test-a-process-for-success-and-matching-outputs" class="md-nav__link">
    <span class="md-ellipsis">
      1. Test a process for success and matching outputs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. Test a process for success and matching outputs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11-generate-a-test-file-stub" class="md-nav__link">
    <span class="md-ellipsis">
      1.1. Generate a test file stub
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-move-the-test-file-and-update-the-script-path" class="md-nav__link">
    <span class="md-ellipsis">
      1.2. Move the test file and update the script path
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13-provide-test-inputs-for-samtools_index" class="md-nav__link">
    <span class="md-ellipsis">
      1.3. Provide test inputs for SAMTOOLS_INDEX
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#14-name-the-test-based-on-functionality" class="md-nav__link">
    <span class="md-ellipsis">
      1.4. Name the test based on functionality
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#15-specify-test-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      1.5. Specify test parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#16-run-the-test-and-examine-the-output" class="md-nav__link">
    <span class="md-ellipsis">
      1.6. Run the test and examine the output
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#17-add-more-tests-to-samtools_index" class="md-nav__link">
    <span class="md-ellipsis">
      1.7. Add more tests to SAMTOOLS_INDEX
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#takeaway_1" class="md-nav__link">
    <span class="md-ellipsis">
      Takeaway
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whats-next_1" class="md-nav__link">
    <span class="md-ellipsis">
      What's next?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>  <li class="md-nav__item">
  <a href="#2-add-tests-to-a-chained-process-and-test-for-contents" class="md-nav__link">
    <span class="md-ellipsis">
      2. Add tests to a chained process and test for contents
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Add tests to a chained process and test for contents">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-generate-and-place-the-test-file" class="md-nav__link">
    <span class="md-ellipsis">
      2.1. Generate and place the test file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-move-the-test-file-and-update-the-script-path" class="md-nav__link">
    <span class="md-ellipsis">
      2.2. Move the test file and update the script path
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-provide-inputs-using-the-setup-method" class="md-nav__link">
    <span class="md-ellipsis">
      2.3. Provide inputs using the setup method
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24-run-again-and-observe-failure" class="md-nav__link">
    <span class="md-ellipsis">
      2.4. Run again and observe failure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#25-use-a-content-assertion-method-to-check-a-specific-variant" class="md-nav__link">
    <span class="md-ellipsis">
      2.5. Use a content assertion method to check a specific variant
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#26-run-again-and-observe-success" class="md-nav__link">
    <span class="md-ellipsis">
      2.6. Run again and observe success
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#27-add-more-tests" class="md-nav__link">
    <span class="md-ellipsis">
      2.7. Add more tests
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#28-run-the-test-command" class="md-nav__link">
    <span class="md-ellipsis">
      2.8. Run the test command
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#takeaway_2" class="md-nav__link">
    <span class="md-ellipsis">
      Takeaway
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whats-next_2" class="md-nav__link">
    <span class="md-ellipsis">
      What's next?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>  <li class="md-nav__item">
  <a href="#3-use-pre-generated-test-data" class="md-nav__link">
    <span class="md-ellipsis">
      3. Use pre-generated test data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Use pre-generated test data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-generate-test-data" class="md-nav__link">
    <span class="md-ellipsis">
      3.1. Generate test data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-generate-the-test-file-stub" class="md-nav__link">
    <span class="md-ellipsis">
      3.2. Generate the test file stub
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-move-the-test-file-and-update-the-script-path" class="md-nav__link">
    <span class="md-ellipsis">
      3.3. Move the test file and update the script path
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-provide-inputs" class="md-nav__link">
    <span class="md-ellipsis">
      3.4. Provide inputs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#35-use-content-assertions" class="md-nav__link">
    <span class="md-ellipsis">
      3.5. Use content assertions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#36-run-the-test" class="md-nav__link">
    <span class="md-ellipsis">
      3.6. Run the test
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#takeaway_3" class="md-nav__link">
    <span class="md-ellipsis">
      Takeaway
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whats-next_3" class="md-nav__link">
    <span class="md-ellipsis">
      What's next?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>  <li class="md-nav__item">
  <a href="#4-add-a-workflow-level-test" class="md-nav__link">
    <span class="md-ellipsis">
      4. Add a workflow-level test
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Add a workflow-level test">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-generate-the-workflow-test" class="md-nav__link">
    <span class="md-ellipsis">
      4.1. Generate the workflow test
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-specify-input-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      4.2. Specify input parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-run-the-workflow-test" class="md-nav__link">
    <span class="md-ellipsis">
      4.3. Run the workflow test
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#44-run-all-tests" class="md-nav__link">
    <span class="md-ellipsis">
      4.4. Run ALL tests
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>  <li class="md-nav__item">
  <a href="#takeaway_4" class="md-nav__link">
    <span class="md-ellipsis">
      Takeaway
    </span>
  </a>
  
</li> 
  </ul>
  
</nav>
<nav class="md-nav md-nav--secondary sidebar_resources" aria-label="Resources">
  <label class="md-nav__title">Resources</label>
  <ul class="md-nav__list">
    <li class="md-nav__item">
      <a
        href="https://nextflow.io/docs/latest/index.html"
        target="_blank"
        rel="noopener"
        class="md-nav__link"
      >
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
          <path
            d="M17.5 14.33c.79 0 1.63.08 2.5.24v1.5c-.62-.16-1.46-.24-2.5-.24-1.9 0-3.39.33-4.5.99v-1.69c1.17-.53 2.67-.8 4.5-.8M13 12.46c1.29-.53 2.79-.79 4.5-.79.79 0 1.63.07 2.5.23v1.5c-.62-.16-1.46-.24-2.5-.24-1.9 0-3.39.34-4.5.99m4.5-3.65c-1.9 0-3.39.32-4.5 1V9.84c1.23-.56 2.73-.84 4.5-.84.79 0 1.63.08 2.5.23v1.55c-.74-.19-1.59-.28-2.5-.28m3.5 8V7c-1.04-.33-2.21-.5-3.5-.5-2.05 0-3.88.5-5.5 1.5v11.5c1.62-1 3.45-1.5 5.5-1.5 1.19 0 2.36.16 3.5.5m-3.5-14c2.35 0 4.19.5 5.5 1.5v14.56c0 .12-.05.24-.16.35-.11.09-.23.17-.34.17-.11 0-.19-.02-.25-.05-1.28-.69-2.87-1.03-4.75-1.03-2.05 0-3.88.5-5.5 1.5-1.34-1-3.17-1.5-5.5-1.5-1.66 0-3.25.36-4.75 1.07-.03.01-.07.01-.12.03-.04.01-.08.02-.13.02-.11 0-.23-.04-.34-.12a.475.475 0 0 1-.16-.35V6c1.34-1 3.18-1.5 5.5-1.5 2.33 0 4.16.5 5.5 1.5 1.34-1 3.17-1.5 5.5-1.5Z"
          ></path>
        </svg>
        Nextflow Docs
      </a>
    </li>
    <li class="md-nav__item">
      <a
        href="https://www.nextflow.io/slack-invite.html"
        target="_blank"
        rel="noopener"
        class="md-nav__link"
      >
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
          <path
            d="M6 15a2 2 0 0 1-2 2 2 2 0 0 1-2-2 2 2 0 0 1 2-2h2v2m1 0a2 2 0 0 1 2-2 2 2 0 0 1 2 2v5a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-5m2-8a2 2 0 0 1-2-2 2 2 0 0 1 2-2 2 2 0 0 1 2 2v2H9m0 1a2 2 0 0 1 2 2 2 2 0 0 1-2 2H4a2 2 0 0 1-2-2 2 2 0 0 1 2-2h5m8 2a2 2 0 0 1 2-2 2 2 0 0 1 2 2 2 2 0 0 1-2 2h-2v-2m-1 0a2 2 0 0 1-2 2 2 2 0 0 1-2-2V5a2 2 0 0 1 2-2 2 2 0 0 1 2 2v5m-2 8a2 2 0 0 1 2 2 2 2 0 0 1-2 2 2 2 0 0 1-2-2v-2h2m0-1a2 2 0 0 1-2-2 2 2 0 0 1 2-2h5a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-5Z"
          ></path>
        </svg>
        Nextflow Slack
      </a>
    </li>
    <li class="md-nav__item">
      <a
        href="https://nextflow.io/"
        target="_blank"
        rel="noopener"
        class="md-nav__link"
      >
        <svg
          version="1.1"
          id="Layer_1"
          xmlns="http://www.w3.org/2000/svg"
          viewBox="80 50 350 350"
        >
          <style type="text/css">
            .st0 {
              fill: "gray";
            }
          </style>
          <path
            class="st0"
            d="M124.5,171.5c39.4,2.6,71.1,34.3,73.5,73.8h46.1c-2.6-65-54.7-117.2-119.6-119.9V171.5z"
          />
          <path
            class="st0"
            d="M198.3,255.8c-2.6,39.5-34.3,71.1-73.8,73.5v46.1c65-2.6,117.2-54.7,119.9-119.6H198.3z"
          />
          <path
            class="st0"
            d="M300.7,245c2.6-39.5,34.3-71.1,73.8-73.5v-46.1c-65,2.6-117.2,54.7-119.9,119.6H300.7z"
          />
          <path
            class="st0"
            d="M374.5,329.3c-39.4-2.6-71.1-34.3-73.5-73.8h-46.1c2.6,65,54.7,117.2,119.6,119.9V329.3z"
          />
        </svg>
        Nextflow Homepage
      </a>
    </li>
    <li class="md-nav__item">
      <a
        href="https://seqera.io/"
        target="_blank"
        rel="noopener"
        class="md-nav__link"
      >
        <?xml version="1.0" encoding="utf-8"?>
        <!-- Generator: Adobe Illustrator 28.3.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->
        <svg
          version="1.1"
          id="Layer_1"
          xmlns="http://www.w3.org/2000/svg"
          xmlns:xlink="http://www.w3.org/1999/xlink"
          x="0px"
          y="0px"
          viewBox="80 50 350 350"
          style="enable-background: new 0 0 500 500"
          xml:space="preserve"
        >
          <style type="text/css">
            .st0 {
              clip-path: url(#SVGID_00000006699037935518914080000000086571810102047141_);
            }
            .st1 {
              fill: "gray";
            }
          </style>
          <g>
            <defs>
              <rect id="SVGID_1_" x="125" y="125" width="250" height="250" />
            </defs>
            <clipPath
              id="SVGID_00000183214694142566821210000012389151436317298101_"
            >
              <use xlink:href="#SVGID_1_" style="overflow: visible" />
            </clipPath>
            <g
              style="
                clip-path: url(#SVGID_00000183214694142566821210000012389151436317298101_);
              "
            >
              <path
                class="st1"
                d="M375,333l-0.1-0.9l-0.1-0.8l-0.1-0.9l-0.1-0.9l-0.1-0.8l-0.1-0.9l-0.1-0.8l-0.2-0.9l-0.2-0.8l-0.2-0.8
                      l-0.2-0.8l-0.2-0.8l-0.2-0.8l-0.3-0.8l-0.3-0.8l-0.3-0.8l-0.3-0.8l-0.4-0.8l-0.4-0.8l-0.4-0.8l-0.4-0.8l-0.4-0.8l-0.4-0.8
                      l-0.4-0.7l-0.5-0.7l-0.5-0.7l-0.5-0.7l-0.5-0.7l-0.5-0.7l-0.5-0.7l-0.5-0.7L365,308l-0.6-0.6l-0.6-0.6l-0.6-0.6l-0.6-0.6L362,305
                      l-0.6-0.6l-0.7-0.6l-0.6-0.5l-1.2,0.7l-0.8,0.5l-0.8,0.4l-0.8,0.4l-0.8,0.4l-0.8,0.4l-0.9,0.4l-0.9,0.4l-0.9,0.3l-0.9,0.3
                      l-0.9,0.3l-0.9,0.3l-0.9,0.3l-0.9,0.3l-0.9,0.2l-0.9,0.2l-0.9,0.2l-0.9,0.2l-0.9,0.2l-0.9,0.1l-0.9,0.1l-0.9,0.1l-0.9,0.1
                      l-0.9,0.1l-0.9,0.1l-0.9,0.1l-0.9,0l-0.9,0h-57.5l59.7,16.4l0.4,0.1l0.4,0.1l0.4,0.1l0.3,0.2l0.3,0.2l0.3,0.2l0.3,0.2l0.3,0.2
                      l0.3,0.2l0.3,0.2l0.3,0.2l0.3,0.3l0.2,0.3l0.2,0.3l0.2,0.3l0.2,0.3l0.2,0.3l0.2,0.3l0.2,0.3l0.1,0.3l0.1,0.3l0.1,0.4l0.1,0.4
                      l0.1,0.4l0.1,0.4l0,0.4l0,0.4l0,0.4l0,0.4l0,0.4l0,0.4l-0.1,0.4l-0.1,0.4l-0.1,0.4l-0.1,0.3l-0.1,0.4l-0.1,0.3l-0.2,0.3l-0.2,0.3
                      l-0.2,0.3l-0.2,0.3l-0.2,0.3l-0.2,0.3l-0.2,0.3l-0.3,0.3l-0.3,0.3l-0.3,0.2l-0.3,0.2l-0.3,0.2l-0.3,0.2l-0.3,0.2l-0.3,0.2
                      l-0.3,0.1l-0.4,0.2l-0.4,0.1l-0.3,0.1l-0.4,0.1l-0.4,0.1l-0.4,0.1l-0.4,0l-0.4,0l-0.4,0H125V375h209.7l0.9,0l0.9,0l0.9,0l0.8-0.1
                      l0.9-0.1l0.8-0.1l0.9-0.1l0.8-0.1l0.8-0.1l0.8-0.2l0.8-0.2l0.8-0.2l0.8-0.2l0.8-0.2l0.8-0.3l0.8-0.3l0.8-0.3l0.8-0.3l0.8-0.3
                      l0.8-0.4l0.8-0.4l0.8-0.4l0.8-0.4l0.8-0.4l0.7-0.4l0.7-0.5l0.7-0.5l0.7-0.5l0.7-0.5l0.7-0.5l0.7-0.5l0.7-0.5l0.7-0.5l0.7-0.5
                      l0.6-0.6l0.6-0.6l0.6-0.6l0.6-0.6l0.6-0.6l0.6-0.6l0.6-0.7l0.5-0.7l0.5-0.7l0.5-0.7l0.5-0.7l0.5-0.7l0.5-0.7l0.5-0.7l0.4-0.7
                      l0.4-0.8l0.4-0.8l0.4-0.8l0.4-0.8l0.4-0.8l0.4-0.8l0.3-0.8l0.3-0.8l0.3-0.8l0.3-0.8l0.2-0.8l0.2-0.8l0.2-0.8l0.2-0.8l0.2-0.8
                      l0.2-0.8l0.1-0.8l0.1-0.9l0.1-0.9l0.1-0.8l0.1-0.9l0.1-0.9l0.1-0.8l0-0.9l0-0.9l0-0.8L375,333z"
              />
              <path
                class="st1"
                d="M375,260.4l-0.1-0.9l-0.1-0.9l-0.1-0.8l-0.1-0.9l-0.1-0.8l-0.1-0.8l-0.1-0.8l-0.2-0.8l-0.2-0.8l-0.2-0.8
                      l-0.2-0.8l-0.2-0.8l-0.2-0.8l-0.3-0.8l-0.3-0.8l-0.3-0.8l-0.3-0.8l-0.4-0.8l-0.4-0.8l-0.4-0.8l-0.4-0.8l-0.4-0.8l-0.4-0.7
                      l-0.4-0.7l-0.5-0.7l-0.5-0.7l-0.5-0.7l-0.5-0.7l-0.2-0.2h0h-89.8l59.7,16.4l0.4,0.1l0.4,0.1l0.4,0.1l0.3,0.2l0.3,0.2l0.3,0.2
                      l0.3,0.2l0.3,0.2l0.3,0.2l0.3,0.2l0.3,0.2l0.3,0.3l0.2,0.3l0.2,0.3l0.2,0.3l0.2,0.3l0.2,0.3l0.2,0.3l0.2,0.3l0.1,0.4l0.1,0.3
                      l0.1,0.4l0.1,0.4l0.1,0.4l0.1,0.4l0,0.4l0,0.4l0,0.4l0,0.4l0,0.4l0,0.4l-0.1,0.4l-0.1,0.4l-0.1,0.4l-0.1,0.4l-0.1,0.3l-0.1,0.4
                      l-0.2,0.4l-0.2,0.3l-0.2,0.3l-0.2,0.3l-0.2,0.3l-0.2,0.3l-0.2,0.3l-0.3,0.3l-0.3,0.3l-0.3,0.2l-0.3,0.2l-0.3,0.2l-0.3,0.2
                      l-0.3,0.2l-0.3,0.2l-0.3,0.2l-0.4,0.2l-0.4,0.1l-0.3,0.1l-0.4,0.1l-0.4,0.1l-0.4,0.1l-0.4,0l-0.4,0l-0.4,0h-82.5h-111H125v32.2
                      h122.8h86.9h0.9l0.9,0l0.9-0.1l0.8-0.1l0.9-0.1l0.8-0.1l0.9-0.1l0.8-0.1l0.8-0.2l0.8-0.2l0.8-0.2l0.8-0.2l0.8-0.2l0.8-0.2l0.8-0.3
                      l0.8-0.3l0.8-0.3l0.8-0.3l0.8-0.3l0.8-0.4l0.8-0.4l0.2-0.1l0.6-0.3l0.8-0.4l0.8-0.4l0.7-0.4l0.7-0.4l0.7-0.5l0.7-0.5l0.7-0.5
                      l0.7-0.5l0.7-0.5l0.7-0.5l0.7-0.5l0.7-0.6l0.6-0.6l0.6-0.6l0.6-0.6l0.6-0.6l0.6-0.6l0.6-0.6l0.6-0.6l0.5-0.7l0.5-0.7l0.5-0.7
                      l0.5-0.7l0.5-0.7l0.5-0.7l0.5-0.7l0.4-0.7l0.4-0.7l0.4-0.8l0.4-0.8l0.4-0.8l0.4-0.8l0.4-0.8l0.3-0.8l0.3-0.8l0.3-0.8l0.3-0.8
                      l0.2-0.8l0.2-0.8l0.2-0.8l0.2-0.8l0.2-0.8l0.2-0.8l0.1-0.8l0.1-0.9l0.1-0.8l0.1-0.9l0.1-0.8l0.1-0.9l0.1-0.9l0-0.8l0-0.9l0-0.9
                      L375,260.4z"
              />
              <path
                class="st1"
                d="M165.3,197.6l-0.9,0l-0.8,0l-0.9,0l-0.9,0.1l-0.8,0.1l-0.9,0.1l-0.8,0.1l-0.8,0.1l-0.8,0.2l-0.8,0.2l-0.8,0.2
                      l-0.8,0.2l-0.8,0.2l-0.8,0.2l-0.8,0.3l-0.8,0.3l-0.8,0.3l-0.8,0.3l-0.8,0.3l-0.8,0.4l-0.8,0.4l-0.2,0.1l-0.6,0.3l-0.8,0.4
                      l-0.8,0.4l-0.8,0.4l-0.7,0.4l-0.7,0.5l-0.7,0.5L142,205l-0.7,0.5l-0.7,0.5l-0.7,0.5l-0.7,0.5l-0.7,0.6l-0.6,0.6l-0.6,0.6l-0.6,0.6
                      l-0.6,0.6l-0.6,0.6l-0.6,0.6l-0.6,0.6l-0.5,0.6l-0.5,0.7l-0.5,0.7l-0.5,0.7l-0.5,0.7l-0.5,0.7l-0.4,0.7l-0.5,0.7l-0.4,0.7
                      l-0.4,0.8l-0.4,0.8l-0.4,0.8l-0.4,0.8l-0.3,0.8l-0.3,0.8l-0.3,0.8l-0.3,0.8l-0.3,0.8l-0.3,0.8l-0.2,0.8l-0.2,0.8l-0.2,0.8
                      l-0.2,0.8l-0.2,0.8l-0.2,0.8l-0.1,0.9l-0.1,0.9l-0.1,0.8l-0.1,0.9l-0.1,0.9l0,0.9l0,0.9v0.9v0.9l0,0.8l0,0.9l0.1,0.8l0.1,0.8
                      l0.1,0.9l0.1,0.9l0.1,0.8l0.2,0.9l0.2,0.8l0.2,0.8l0.2,0.8l0.2,0.8l0.2,0.8l0.3,0.8l0.3,0.8l0.3,0.8l0.3,0.8l0.3,0.8l0.3,0.8
                      l0.4,0.8l0.4,0.8l0.4,0.8l0.4,0.8l0.4,0.7l0.5,0.7l0.4,0.7l0.5,0.7l0.5,0.7l0.5,0.7l0.2,0.2h89.8l-59.7-16.4l-0.4-0.1l-0.3-0.1
                      l-0.4-0.1l-0.3-0.2l-0.3-0.2l-0.3-0.2l-0.3-0.2l-0.3-0.2l-0.3-0.2l-0.3-0.2l-0.3-0.2l-0.2-0.3l-0.2-0.3l-0.2-0.3l-0.2-0.3
                      l-0.2-0.3l-0.2-0.3l-0.2-0.3l-0.2-0.3l-0.1-0.4l-0.1-0.4l-0.1-0.3l-0.1-0.4l-0.1-0.4l-0.1-0.4l0-0.4l0-0.4l0-0.4l0-0.4l0-0.4
                      l0-0.4l0.1-0.4l0.1-0.4l0.1-0.4l0.1-0.4l0.1-0.4l0.1-0.3l0.2-0.3l0.2-0.3l0.2-0.3l0.2-0.3l0.2-0.3l0.2-0.3l0.2-0.3l0.2-0.3
                      l0.3-0.3l0.3-0.2l0.3-0.2l0.3-0.2l0.3-0.2l0.3-0.2l0.3-0.2l0.3-0.2l0.4-0.2l0.3-0.1l0.4-0.1l0.4-0.1l0.4-0.1l0.4-0.1l0.4,0l0.4,0
                      h0.4h82.5h111H375v-32.3H252.2H165.3z"
              />
              <path
                class="st1"
                d="M165.3,125l-0.9,0l-0.8,0l-0.9,0.1l-0.9,0.1l-0.8,0.1l-0.9,0.1l-0.8,0.1l-0.8,0.1l-0.8,0.2l-0.8,0.2l-0.8,0.2
                      l-0.8,0.2l-0.8,0.2l-0.8,0.2l-0.8,0.3l-0.8,0.3l-0.8,0.3l-0.8,0.3l-0.8,0.3l-0.8,0.3l-0.8,0.4l-0.8,0.4l-0.8,0.4l-0.8,0.4
                      l-0.8,0.4l-0.7,0.5l-0.7,0.4l-0.7,0.5l-0.7,0.5l-0.7,0.5l-0.7,0.5l-0.7,0.5l-0.7,0.6l-0.7,0.6l-0.6,0.6l-0.6,0.6l-0.6,0.6
                      l-0.6,0.6l-0.6,0.6l-0.6,0.6l-0.6,0.6l-0.5,0.7l-0.5,0.7l-0.5,0.7l-0.5,0.7l-0.5,0.7l-0.5,0.7l-0.4,0.7l-0.5,0.7l-0.4,0.7
                      l-0.4,0.8l-0.4,0.8l-0.4,0.8l-0.4,0.8l-0.3,0.8l-0.3,0.8l-0.3,0.8l-0.3,0.8l-0.3,0.8l-0.3,0.8l-0.2,0.8l-0.2,0.8l-0.2,0.8
                      l-0.2,0.8l-0.2,0.8l-0.2,0.8l-0.1,0.9l-0.1,0.8l-0.1,0.9l-0.1,0.8l-0.1,0.9l0,0.9l0,0.9v0.9v0.9l0,0.9l0,0.8l0.1,0.9l0.1,0.9
                      l0.1,0.8l0.1,0.8l0.1,0.8l0.2,0.8l0.2,0.8l0.2,0.8l0.2,0.8l0.2,0.8l0.2,0.8l0.3,0.8l0.3,0.8l0.3,0.8l0.3,0.8l0.3,0.8l0.3,0.8
                      l0.4,0.8l0.4,0.8l0.4,0.8l0.4,0.8l0.4,0.7l0.5,0.7l0.4,0.7l0.5,0.7l0.5,0.7l0.5,0.7l0.5,0.7l0.5,0.7l0.5,0.7l0.6,0.6l0.6,0.6
                      l0.6,0.6l0.6,0.6l0.6,0.6l0.6,0.6l0.6,0.6l0.7,0.6l0.6,0.5h0l1.1-0.7l0.8-0.5l0.8-0.5l0.8-0.4l0.8-0.4l0.9-0.4l0.9-0.4l0.9-0.4
                      l0.9-0.3l0.9-0.3l0.9-0.3l0.9-0.3l0.9-0.3l0.9-0.3l0.9-0.2l0.9-0.2l0.9-0.2l0.9-0.2l0.9-0.2l0.9-0.1l0.9-0.1l0.9-0.1l0.9-0.1
                      l0.9-0.1l0.9-0.1l0.9,0l0.9,0l0.9,0h57.5l-59.7-16.4l-0.4-0.1l-0.3-0.1l-0.4-0.1l-0.3-0.1l-0.3-0.2l-0.3-0.2l-0.3-0.2l-0.3-0.2
                      l-0.3-0.2l-0.3-0.2l-0.3-0.3l-0.2-0.3l-0.2-0.3l-0.2-0.3l-0.2-0.3l-0.2-0.3l-0.2-0.3l-0.2-0.3l-0.2-0.3l-0.1-0.3l-0.1-0.4
                      l-0.1-0.3l-0.1-0.4l-0.1-0.4l-0.1-0.4l0-0.4l0-0.4l0-0.4l0-0.4l0-0.4l0-0.4l0.1-0.4l0.1-0.4l0.1-0.4l0.1-0.4l0.1-0.4l0.1-0.3
                      l0.2-0.3l0.2-0.3l0.2-0.3l0.2-0.3l0.2-0.3l0.2-0.3l0.2-0.3l0.2-0.3l0.3-0.2l0.3-0.2l0.3-0.2l0.3-0.2l0.3-0.2l0.3-0.2l0.3-0.2
                      l0.3-0.2l0.4-0.1l0.3-0.1l0.4-0.1l0.4-0.1l0.4-0.1l0.4-0.1l0.4,0l0.4,0l0.4,0H375V125H165.3z"
              />
            </g>
          </g>
        </svg>
        Seqera
      </a>
    </li>
    <li class="md-nav__item">
      <a
        href="https://github.com/nextflow-io/training"
        target="_blank"
        rel="noopener"
        class="md-nav__link"
      >
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
          <path
            d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33.85 0 1.71.11 2.5.33 1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2Z"
          ></path>
        </svg>
        Training on GitHub
      </a>
    </li>
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/nextflow-io/training/edit/master/docs/nf4_science/genomics/04_testing.md" title="이 페이지를 편집" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  


<h1 id="part-4-adding-tests">Part 4: Adding tests<a class="headerlink" href="#part-4-adding-tests" title="Permanent link">&para;</a></h1>
<p>In the first part of this course, you built a variant calling pipeline that was completely linear and processed each sample's data independently of the others.</p>
<p>In the second part, we showed you how to use channels and channel operators to implement joint variant calling with GATK.</p>
<p>In the third part, we modularized the pipeline.</p>
<p>In this part of the training, we're going to show you how to use <a href="https://www.nf-test.com/"><strong>nf-test</strong></a>, a testing framework that integrates well with Nextflow and makes it straightforward to add both module-level and workflow-level tests to your pipeline. To follow this part of the training, you should have completed Part 1, Part 2, and Part 3, as well as the <a href="../../../side_quests/nf-test/">nf-test side quest</a>, which covers the basics of nf-test, and why testing is important.</p>
<hr />
<h2 id="0-warmup">0. Warmup<a class="headerlink" href="#0-warmup" title="Permanent link">&para;</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Make sure you're in the correct working directory:
 <code>cd /workspaces/training/nf4-science/genomics</code></p>
</div>
<p>If you worked through the previous parts of this training course, you should have a working version of the genomics pipeline, with a modules directory structure like:</p>
<div class="highlight"><span class="filename">Directory structure</span><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="go">modules/</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="go">├── gatk</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="go">│   ├── haplotypecaller</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="go">│   │   └── main.nf</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="go">│   └── jointgenotyping</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="go">│       └── main.nf</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="go">└── samtools</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="go">    └── index</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="go">        └── main.nf</span>
</code></pre></div>
<p>This modules directory can be found in the <code>solutions</code> directory if you need it.</p>
<p>We're going to start with the same workflow as in Part 3, which we've provided for you in the file <code>genomics-4.nf</code>. Exactly as for the <a href="../../../side_quests/nf-test/">nf-test side quest</a>, we're going to add a few different types of tests to the three processes in this pipeline, as well as a workflow-level test.</p>
<h3 id="01-check-the-workflow-runs">0.1. Check the workflow runs<a class="headerlink" href="#01-check-the-workflow-runs" title="Permanent link">&para;</a></h3>
<p>Before we start adding tests, let's make sure the workflow runs as expected.</p>
<p>Let's try running that now.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>nextflow<span class="w"> </span>run<span class="w"> </span>genomics-4.nf<span class="w"> </span>-resume
</code></pre></div>
<p>This should look very familiar by now if you've been working through this training course from the start.</p>
<div class="highlight"><span class="filename">Output</span><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="go"> N E X T F L O W   ~  version 24.10.0</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="go">Launching `genomics-4.nf` [gloomy_poincare] DSL2 - revision: 43203316e0</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="go">executor &gt;  local (7)</span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="go">[18/89dfa4] SAMTOOLS_INDEX (1)       | 3 of 3 ✔</span>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="go">[30/b2522b] GATK_HAPLOTYPECALLER (2) | 3 of 3 ✔</span>
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="go">[a8/d2c189] GATK_JOINTGENOTYPING     | 1 of 1 ✔</span>
</code></pre></div>
<p>Like previously, there will now be a <code>work</code> directory and a <code>results_genomics</code> directory inside your project directory. We'll actually make use of these results later on in our testing. But from now on we're going to be using the <code>nf-test</code> package to test the pipeline.</p>
<h3 id="02-initialize-nf-test">0.2. Initialize <code>nf-test</code><a class="headerlink" href="#02-initialize-nf-test" title="Permanent link">&para;</a></h3>
<p>As for the <a href="../../../side_quests/nf-test/">nf-test side quest</a>, we need to initialize the <code>nf-test</code> package.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>nf-test<span class="w"> </span>init
</code></pre></div>
<p>This should produce the following output:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>🚀<span class="w"> </span>nf-test<span class="w"> </span><span class="m">0</span>.9.2
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>https://www.nf-test.com
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="o">(</span>c<span class="o">)</span><span class="w"> </span><span class="m">2021</span><span class="w"> </span>-<span class="w"> </span><span class="m">2024</span><span class="w"> </span>Lukas<span class="w"> </span>Forer<span class="w"> </span>and<span class="w"> </span>Sebastian<span class="w"> </span>Schoenherr
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>Project<span class="w"> </span>configured.<span class="w"> </span>Configuration<span class="w"> </span>is<span class="w"> </span>stored<span class="w"> </span><span class="k">in</span><span class="w"> </span>nf-test.config
</code></pre></div>
<p>It also creates a <code>tests</code> directory containing a configuration file stub.</p>
<h3 id="takeaway">Takeaway<a class="headerlink" href="#takeaway" title="Permanent link">&para;</a></h3>
<p>Now we're ready to start writing tests for our genomics pipeline.</p>
<h3 id="whats-next">What's next?<a class="headerlink" href="#whats-next" title="Permanent link">&para;</a></h3>
<p>Write basic tests that evaluate whether the process calls were successful and produced the correct outputs.</p>
<hr />
<h2 id="1-test-a-process-for-success-and-matching-outputs">1. Test a process for success and matching outputs<a class="headerlink" href="#1-test-a-process-for-success-and-matching-outputs" title="Permanent link">&para;</a></h2>
<p>We'll start by testing the <code>SAMTOOLS_INDEX</code> process, which creates index files for BAM files to enable efficient random access. This is a good first test case because:</p>
<ol>
<li>It has a single, well-defined input (a BAM file)</li>
<li>It produces a predictable output (a BAI index file)</li>
<li>The output should be identical for identical inputs</li>
</ol>
<h3 id="11-generate-a-test-file-stub">1.1. Generate a test file stub<a class="headerlink" href="#11-generate-a-test-file-stub" title="Permanent link">&para;</a></h3>
<p>First, generate a test file stub:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>nf-test<span class="w"> </span>generate<span class="w"> </span>process<span class="w"> </span>modules/samtools/index/main.nf
</code></pre></div>
<p>This creates a file in the same directory as <code>main.nf</code>, summarized in the terminal output as follows:</p>
<div class="highlight"><span class="filename">Output</span><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="go">Load source file &#39;/workspaces/training/nf4-science/genomics/modules/samtools/index/main.nf&#39;</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="go">Wrote process test file &#39;/workspaces/training/nf4-science/genomics/tests/modules/samtools/index/main.nf.test</span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="go">SUCCESS: Generated 1 test files.</span>
</code></pre></div>
<p>You can navigate to the directory in the file explorer and open the file, which should contain the following code:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">tests/modules/samtools/index/main.nf.test</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-7-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-7-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-7-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-7-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-7-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-7-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-7-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-7-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-7-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-7-10">10</a></span>
<span class="normal"><a href="#__codelineno-7-11">11</a></span>
<span class="normal"><a href="#__codelineno-7-12">12</a></span>
<span class="normal"><a href="#__codelineno-7-13">13</a></span>
<span class="normal"><a href="#__codelineno-7-14">14</a></span>
<span class="normal"><a href="#__codelineno-7-15">15</a></span>
<span class="normal"><a href="#__codelineno-7-16">16</a></span>
<span class="normal"><a href="#__codelineno-7-17">17</a></span>
<span class="normal"><a href="#__codelineno-7-18">18</a></span>
<span class="normal"><a href="#__codelineno-7-19">19</a></span>
<span class="normal"><a href="#__codelineno-7-20">20</a></span>
<span class="normal"><a href="#__codelineno-7-21">21</a></span>
<span class="normal"><a href="#__codelineno-7-22">22</a></span>
<span class="normal"><a href="#__codelineno-7-23">23</a></span>
<span class="normal"><a href="#__codelineno-7-24">24</a></span>
<span class="normal"><a href="#__codelineno-7-25">25</a></span>
<span class="normal"><a href="#__codelineno-7-26">26</a></span>
<span class="normal"><a href="#__codelineno-7-27">27</a></span>
<span class="normal"><a href="#__codelineno-7-28">28</a></span>
<span class="normal"><a href="#__codelineno-7-29">29</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="n">nextflow_process</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-7-2" name="__codelineno-7-2"></a>
<a id="__codelineno-7-3" name="__codelineno-7-3"></a><span class="w">    </span><span class="n">name</span><span class="w"> </span><span class="s2">&quot;Test Process SAMTOOLS_INDEX&quot;</span>
<a id="__codelineno-7-4" name="__codelineno-7-4"></a><span class="w">    </span><span class="n">script</span><span class="w"> </span><span class="s2">&quot;modules/samtools/index/main.nf&quot;</span>
<a id="__codelineno-7-5" name="__codelineno-7-5"></a><span class="w">    </span><span class="n">process</span><span class="w"> </span><span class="s2">&quot;SAMTOOLS_INDEX&quot;</span>
<a id="__codelineno-7-6" name="__codelineno-7-6"></a>
<a id="__codelineno-7-7" name="__codelineno-7-7"></a><span class="w">    </span><span class="n">test</span><span class="o">(</span><span class="s2">&quot;Should run without failures&quot;</span><span class="o">)</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-7-8" name="__codelineno-7-8"></a>
<a id="__codelineno-7-9" name="__codelineno-7-9"></a><span class="w">        </span><span class="n">when</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-7-10" name="__codelineno-7-10"></a><span class="w">            </span><span class="n">params</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-7-11" name="__codelineno-7-11"></a><span class="w">                </span><span class="c1">// define parameters here. Example:</span>
<a id="__codelineno-7-12" name="__codelineno-7-12"></a><span class="w">                </span><span class="c1">// outdir = &quot;tests/results&quot;</span>
<a id="__codelineno-7-13" name="__codelineno-7-13"></a><span class="w">            </span><span class="o">}</span>
<a id="__codelineno-7-14" name="__codelineno-7-14"></a><span class="w">            </span><span class="n">process</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-7-15" name="__codelineno-7-15"></a><span class="w">                </span><span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-7-16" name="__codelineno-7-16"></a><span class="s2">                // define inputs of the process here. Example:</span>
<a id="__codelineno-7-17" name="__codelineno-7-17"></a><span class="s2">                // input[0] = file(&quot;test-file.txt&quot;)</span>
<a id="__codelineno-7-18" name="__codelineno-7-18"></a><span class="s2">                &quot;&quot;&quot;</span>
<a id="__codelineno-7-19" name="__codelineno-7-19"></a><span class="w">            </span><span class="o">}</span>
<a id="__codelineno-7-20" name="__codelineno-7-20"></a><span class="w">        </span><span class="o">}</span>
<a id="__codelineno-7-21" name="__codelineno-7-21"></a>
<a id="__codelineno-7-22" name="__codelineno-7-22"></a><span class="w">        </span><span class="n">then</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-7-23" name="__codelineno-7-23"></a><span class="w">            </span><span class="k">assert</span><span class="w"> </span><span class="n">process</span><span class="o">.</span><span class="na">success</span>
<a id="__codelineno-7-24" name="__codelineno-7-24"></a><span class="w">            </span><span class="k">assert</span><span class="w"> </span><span class="n">snapshot</span><span class="o">(</span><span class="n">process</span><span class="o">.</span><span class="na">out</span><span class="o">).</span><span class="na">match</span><span class="o">()</span>
<a id="__codelineno-7-25" name="__codelineno-7-25"></a><span class="w">        </span><span class="o">}</span>
<a id="__codelineno-7-26" name="__codelineno-7-26"></a>
<a id="__codelineno-7-27" name="__codelineno-7-27"></a><span class="w">    </span><span class="o">}</span>
<a id="__codelineno-7-28" name="__codelineno-7-28"></a>
<a id="__codelineno-7-29" name="__codelineno-7-29"></a><span class="o">}</span>
</code></pre></div></td></tr></table></div>
<p>The starting assertions should be familiar from the <a href="../../../side_quests/nf-test/">nf-test side quest</a>:</p>
<ul>
<li><code>assert process.success</code> states that we expect the process to run successfully and complete without any failures.</li>
<li><code>snapshot(process.out).match()</code> states that we expect the result of the run to be identical to the result obtained in a previous run (if applicable).
  We discuss this in more detail later.</li>
</ul>
<p>Using this as a starting point, we need to add the right test inputs for the samtools index process, and any parameters if applicable.</p>
<h3 id="12-move-the-test-file-and-update-the-script-path">1.2. Move the test file and update the script path<a class="headerlink" href="#12-move-the-test-file-and-update-the-script-path" title="Permanent link">&para;</a></h3>
<p>Before we get to work on filling out the test, we need to move the file to its definitive location. Part of the reason we added a directory for each module is that we can now ship tests in a <code>tests</code> directory co-located with each module's <code>main.nf</code> file. Let's create that directory and move the test file there.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>mkdir<span class="w"> </span>-p<span class="w"> </span>modules/samtools/index/tests
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>mv<span class="w"> </span>tests/modules/samtools/index/main.nf.test<span class="w"> </span>modules/samtools/index/tests/
</code></pre></div>
<p>Now we can simplify the <code>script</code> section of the test file to a relative path:</p>
<p><em>Before:</em></p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">modules/samtools/index/tests/main.nf.test</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-9-3">3</a></span>
<span class="normal"><a href="#__codelineno-9-4">4</a></span>
<span class="normal"><a href="#__codelineno-9-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-9-3" name="__codelineno-9-3"></a><span class="n">name</span><span class="w"> </span><span class="s2">&quot;Test Process SAMTOOLS_INDEX&quot;</span>
<a id="__codelineno-9-4" name="__codelineno-9-4"></a><span class="hll"><span class="n">script</span><span class="w"> </span><span class="s2">&quot;modules/samtools/index/main.nf&quot;</span>
</span><a id="__codelineno-9-5" name="__codelineno-9-5"></a><span class="n">process</span><span class="w"> </span><span class="s2">&quot;SAMTOOLS_INDEX&quot;</span>
</code></pre></div></td></tr></table></div>
<p><em>After:</em></p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">modules/samtools/index/tests/main.nf.test</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-10-3">3</a></span>
<span class="normal"><a href="#__codelineno-10-4">4</a></span>
<span class="normal"><a href="#__codelineno-10-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-10-3" name="__codelineno-10-3"></a><span class="n">name</span><span class="w"> </span><span class="s2">&quot;Test Process SAMTOOLS_INDEX&quot;</span>
<a id="__codelineno-10-4" name="__codelineno-10-4"></a><span class="hll"><span class="n">script</span><span class="w"> </span><span class="s2">&quot;../main.nf&quot;</span>
</span><a id="__codelineno-10-5" name="__codelineno-10-5"></a><span class="n">process</span><span class="w"> </span><span class="s2">&quot;SAMTOOLS_INDEX&quot;</span>
</code></pre></div></td></tr></table></div>
<p>This tells the test where to find the module's <code>main.nf</code> file, without having to specify the full path.</p>
<h3 id="13-provide-test-inputs-for-samtools_index">1.3. Provide test inputs for SAMTOOLS_INDEX<a class="headerlink" href="#13-provide-test-inputs-for-samtools_index" title="Permanent link">&para;</a></h3>
<p>The stub file includes a placeholder that we need to replace with an actual test input, appropriate to the input of <code>samtools index</code>. The appropriate input is a BAM file, which we have available in the <code>data/bam</code> directory.</p>
<p><em>Before:</em></p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">modules/samtools/index/tests/main.nf.test</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-11-14">14</a></span>
<span class="normal"><a href="#__codelineno-11-15">15</a></span>
<span class="normal"><a href="#__codelineno-11-16">16</a></span>
<span class="normal"><a href="#__codelineno-11-17">17</a></span>
<span class="normal"><a href="#__codelineno-11-18">18</a></span>
<span class="normal"><a href="#__codelineno-11-19">19</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-11-14" name="__codelineno-11-14"></a><span class="n">process</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-11-15" name="__codelineno-11-15"></a><span class="w">    </span><span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-11-16" name="__codelineno-11-16"></a><span class="s2">    // define inputs of the process here. Example:</span>
<a id="__codelineno-11-17" name="__codelineno-11-17"></a><span class="s2">    // input[0] = file(&quot;test-file.txt&quot;)</span>
<a id="__codelineno-11-18" name="__codelineno-11-18"></a><span class="s2">    &quot;&quot;&quot;</span>
<a id="__codelineno-11-19" name="__codelineno-11-19"></a><span class="o">}</span>
</code></pre></div></td></tr></table></div>
<p><em>After:</em></p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">modules/samtools/index/tests/main.nf.test</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-12-14">14</a></span>
<span class="normal"><a href="#__codelineno-12-15">15</a></span>
<span class="normal"><a href="#__codelineno-12-16">16</a></span>
<span class="normal"><a href="#__codelineno-12-17">17</a></span>
<span class="normal"><a href="#__codelineno-12-18">18</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-12-14" name="__codelineno-12-14"></a><span class="n">process</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-12-15" name="__codelineno-12-15"></a><span class="w">    </span><span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-12-16" name="__codelineno-12-16"></a><span class="s2">    input[0] = file(&quot;${projectDir}/data/bam/reads_son.bam&quot;)</span>
<a id="__codelineno-12-17" name="__codelineno-12-17"></a><span class="s2">    &quot;&quot;&quot;</span>
<a id="__codelineno-12-18" name="__codelineno-12-18"></a><span class="o">}</span>
</code></pre></div></td></tr></table></div>
<h3 id="14-name-the-test-based-on-functionality">1.4. Name the test based on functionality<a class="headerlink" href="#14-name-the-test-based-on-functionality" title="Permanent link">&para;</a></h3>
<p>As we learned before, it's good practice to rename the test to something that makes sense in the context of the test.</p>
<p><em>Before:</em></p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">modules/samtools/index/tests/main.nf.test</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-13-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-13-7" name="__codelineno-13-7"></a><span class="n">test</span><span class="o">(</span><span class="s2">&quot;Should run without failures&quot;</span><span class="o">)</span><span class="w"> </span><span class="o">{</span>
</code></pre></div></td></tr></table></div>
<p>This takes an arbitrary string, so we could put anything we want.
Here we choose to refer to the file name and its format:</p>
<p><em>After:</em></p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">modules/samtools/index/tests/main.nf.test</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-14-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-14-7" name="__codelineno-14-7"></a><span class="n">test</span><span class="o">(</span><span class="s2">&quot;Should index reads_son.bam correctly&quot;</span><span class="o">)</span><span class="w"> </span><span class="o">{</span>
</code></pre></div></td></tr></table></div>
<h3 id="15-specify-test-parameters">1.5. Specify test parameters<a class="headerlink" href="#15-specify-test-parameters" title="Permanent link">&para;</a></h3>
<p>The <code>params</code> block in the stub file includes a placeholder for parameters:</p>
<p><em>Before:</em></p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">modules/samtools/index/tests/main.nf.test</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-15-11">11</a></span>
<span class="normal"><a href="#__codelineno-15-12">12</a></span>
<span class="normal"><a href="#__codelineno-15-13">13</a></span>
<span class="normal"><a href="#__codelineno-15-14">14</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-15-11" name="__codelineno-15-11"></a><span class="n">params</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-15-12" name="__codelineno-15-12"></a><span class="w">    </span><span class="c1">// define parameters here. Example:</span>
<a id="__codelineno-15-13" name="__codelineno-15-13"></a><span class="w">    </span><span class="c1">// outdir = &quot;tests/results&quot;</span>
<a id="__codelineno-15-14" name="__codelineno-15-14"></a><span class="o">}</span>
</code></pre></div></td></tr></table></div>
<p>We use it to specify a location for the results to be output, using the default suggestion:</p>
<p><em>After:</em></p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">modules/samtools/index/tests/main.nf.test</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-16-11">11</a></span>
<span class="normal"><a href="#__codelineno-16-12">12</a></span>
<span class="normal"><a href="#__codelineno-16-13">13</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-16-11" name="__codelineno-16-11"></a><span class="n">params</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-16-12" name="__codelineno-16-12"></a><span class="w">    </span><span class="n">outdir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;tests/results&quot;</span>
<a id="__codelineno-16-13" name="__codelineno-16-13"></a><span class="o">}</span>
</code></pre></div></td></tr></table></div>
<h3 id="16-run-the-test-and-examine-the-output">1.6. Run the test and examine the output<a class="headerlink" href="#16-run-the-test-and-examine-the-output" title="Permanent link">&para;</a></h3>
<p>Run the test:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>nf-test<span class="w"> </span><span class="nb">test</span><span class="w"> </span>modules/samtools/index/tests/main.nf.test
</code></pre></div>
<p>This should produce:</p>
<div class="highlight"><span class="filename">Output</span><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="go">🚀 nf-test 0.9.2</span>
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="go">https://www.nf-test.com</span>
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="gp gp-VirtualEnv">(c)</span> <span class="go">2021 - 2024 Lukas Forer and Sebastian Schoenherr</span>
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a>
<a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a>
<a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a><span class="go">Test Process SAMTOOLS_INDEX</span>
<a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a>
<a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a><span class="go">  Test [e761f2e2] &#39;Should index reads_son.bam correctly&#39; PASSED (11.226s)</span>
<a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a><span class="go">  Snapshots:</span>
<a id="__codelineno-18-10" name="__codelineno-18-10" href="#__codelineno-18-10"></a><span class="go">    1 created [Should index reads_son.bam correctly]</span>
<a id="__codelineno-18-11" name="__codelineno-18-11" href="#__codelineno-18-11"></a>
<a id="__codelineno-18-12" name="__codelineno-18-12" href="#__codelineno-18-12"></a>
<a id="__codelineno-18-13" name="__codelineno-18-13" href="#__codelineno-18-13"></a><span class="go">Snapshot Summary:</span>
<a id="__codelineno-18-14" name="__codelineno-18-14" href="#__codelineno-18-14"></a><span class="go">  1 created</span>
<a id="__codelineno-18-15" name="__codelineno-18-15" href="#__codelineno-18-15"></a>
<a id="__codelineno-18-16" name="__codelineno-18-16" href="#__codelineno-18-16"></a><span class="go">SUCCESS: Executed 1 tests in 11.265s</span>
</code></pre></div>
<p>As we learned previously, this verified the basic assertion about the success of the process and created a snapshot file based on the output of the process. We can see the contents of the snapshot file in the <code>tests/modules/samtools/index/tests/main.nf.test.snap</code> file:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">tests/modules/samtools/index/tests/main.nf.test.snap</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-19-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-19-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-19-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-19-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-19-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-19-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-19-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-19-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-19-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-19-10">10</a></span>
<span class="normal"><a href="#__codelineno-19-11">11</a></span>
<span class="normal"><a href="#__codelineno-19-12">12</a></span>
<span class="normal"><a href="#__codelineno-19-13">13</a></span>
<span class="normal"><a href="#__codelineno-19-14">14</a></span>
<span class="normal"><a href="#__codelineno-19-15">15</a></span>
<span class="normal"><a href="#__codelineno-19-16">16</a></span>
<span class="normal"><a href="#__codelineno-19-17">17</a></span>
<span class="normal"><a href="#__codelineno-19-18">18</a></span>
<span class="normal"><a href="#__codelineno-19-19">19</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1"></a><span class="p">{</span>
<a id="__codelineno-19-2" name="__codelineno-19-2"></a><span class="w">  </span><span class="nt">&quot;Should index reads_son.bam correctly&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-19-3" name="__codelineno-19-3"></a><span class="w">    </span><span class="nt">&quot;content&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<a id="__codelineno-19-4" name="__codelineno-19-4"></a><span class="w">      </span><span class="p">{</span>
<a id="__codelineno-19-5" name="__codelineno-19-5"></a><span class="w">        </span><span class="nt">&quot;0&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<a id="__codelineno-19-6" name="__codelineno-19-6"></a><span class="w">          </span><span class="p">[</span>
<a id="__codelineno-19-7" name="__codelineno-19-7"></a><span class="w">            </span><span class="s2">&quot;reads_son.bam:md5,af5956d9388ba017944bef276b71d809&quot;</span><span class="p">,</span>
<a id="__codelineno-19-8" name="__codelineno-19-8"></a><span class="w">            </span><span class="s2">&quot;reads_son.bam.bai:md5,a2ca7b84998218ee77eff14af8eb8ca2&quot;</span>
<a id="__codelineno-19-9" name="__codelineno-19-9"></a><span class="w">          </span><span class="p">]</span>
<a id="__codelineno-19-10" name="__codelineno-19-10"></a><span class="w">        </span><span class="p">]</span>
<a id="__codelineno-19-11" name="__codelineno-19-11"></a><span class="w">      </span><span class="p">}</span>
<a id="__codelineno-19-12" name="__codelineno-19-12"></a><span class="w">    </span><span class="p">],</span>
<a id="__codelineno-19-13" name="__codelineno-19-13"></a><span class="w">    </span><span class="nt">&quot;meta&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-19-14" name="__codelineno-19-14"></a><span class="w">      </span><span class="nt">&quot;nf-test&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;0.9.2&quot;</span><span class="p">,</span>
<a id="__codelineno-19-15" name="__codelineno-19-15"></a><span class="w">      </span><span class="nt">&quot;nextflow&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;24.10.0&quot;</span>
<a id="__codelineno-19-16" name="__codelineno-19-16"></a><span class="w">    </span><span class="p">},</span>
<a id="__codelineno-19-17" name="__codelineno-19-17"></a><span class="w">    </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2025-03-03T16:59:54.195992321&quot;</span>
<a id="__codelineno-19-18" name="__codelineno-19-18"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-19-19" name="__codelineno-19-19"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>We can also run the test again and see that it passes, because the output is identical to the snapshot:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a>nf-test<span class="w"> </span><span class="nb">test</span><span class="w"> </span>modules/samtools/index/tests/main.nf.test
</code></pre></div>
<p>This produces:</p>
<div class="highlight"><span class="filename">Output</span><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="go">🚀 nf-test 0.9.2</span>
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="go">https://www.nf-test.com</span>
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="gp gp-VirtualEnv">(c)</span> <span class="go">2021 - 2024 Lukas Forer and Sebastian Schoenherr</span>
<a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a>
<a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a>
<a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a><span class="go">Test Process SAMTOOLS_INDEX</span>
<a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a>
<a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a><span class="go">  Test [625e39ee] &#39;Should index reads_son.bam correctly&#39; PASSED (11.91s)</span>
<a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a>
<a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a>
<a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a><span class="go">SUCCESS: Executed 1 tests in 11.947s</span>
</code></pre></div>
<h3 id="17-add-more-tests-to-samtools_index">1.7. Add more tests to <code>SAMTOOLS_INDEX</code><a class="headerlink" href="#17-add-more-tests-to-samtools_index" title="Permanent link">&para;</a></h3>
<p>Sometimes it's useful to test a range of different input files to ensure we're testing for a variety of potential issues. Let's also test for the mother and father's bam files in the trio from our test data. Add the following tests to the test file:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>    test(&quot;Should index reads_mother.bam correctly&quot;) {
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a>
<a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a>        when {
<a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a>            params {
<a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a>                outdir = &quot;tests/results&quot;
<a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a>            }
<a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a>            process {
<a id="__codelineno-22-8" name="__codelineno-22-8" href="#__codelineno-22-8"></a>                &quot;&quot;&quot;
<a id="__codelineno-22-9" name="__codelineno-22-9" href="#__codelineno-22-9"></a>                input[0] = file(&quot;${projectDir}/data/bam/reads_mother.bam&quot;)
<a id="__codelineno-22-10" name="__codelineno-22-10" href="#__codelineno-22-10"></a>                &quot;&quot;&quot;
<a id="__codelineno-22-11" name="__codelineno-22-11" href="#__codelineno-22-11"></a>            }
<a id="__codelineno-22-12" name="__codelineno-22-12" href="#__codelineno-22-12"></a>        }
<a id="__codelineno-22-13" name="__codelineno-22-13" href="#__codelineno-22-13"></a>
<a id="__codelineno-22-14" name="__codelineno-22-14" href="#__codelineno-22-14"></a>        then {
<a id="__codelineno-22-15" name="__codelineno-22-15" href="#__codelineno-22-15"></a>            assert process.success
<a id="__codelineno-22-16" name="__codelineno-22-16" href="#__codelineno-22-16"></a>            assert snapshot(process.out).match()
<a id="__codelineno-22-17" name="__codelineno-22-17" href="#__codelineno-22-17"></a>        }
<a id="__codelineno-22-18" name="__codelineno-22-18" href="#__codelineno-22-18"></a>
<a id="__codelineno-22-19" name="__codelineno-22-19" href="#__codelineno-22-19"></a>    }
<a id="__codelineno-22-20" name="__codelineno-22-20" href="#__codelineno-22-20"></a>
<a id="__codelineno-22-21" name="__codelineno-22-21" href="#__codelineno-22-21"></a>    test(&quot;Should index reads_father.bam correctly&quot;) {
<a id="__codelineno-22-22" name="__codelineno-22-22" href="#__codelineno-22-22"></a>
<a id="__codelineno-22-23" name="__codelineno-22-23" href="#__codelineno-22-23"></a>        when {
<a id="__codelineno-22-24" name="__codelineno-22-24" href="#__codelineno-22-24"></a>            params {
<a id="__codelineno-22-25" name="__codelineno-22-25" href="#__codelineno-22-25"></a>                outdir = &quot;tests/results&quot;
<a id="__codelineno-22-26" name="__codelineno-22-26" href="#__codelineno-22-26"></a>            }
<a id="__codelineno-22-27" name="__codelineno-22-27" href="#__codelineno-22-27"></a>            process {
<a id="__codelineno-22-28" name="__codelineno-22-28" href="#__codelineno-22-28"></a>                &quot;&quot;&quot;
<a id="__codelineno-22-29" name="__codelineno-22-29" href="#__codelineno-22-29"></a>                input[0] = file(&quot;${projectDir}/data/bam/reads_father.bam&quot;)
<a id="__codelineno-22-30" name="__codelineno-22-30" href="#__codelineno-22-30"></a>                &quot;&quot;&quot;
<a id="__codelineno-22-31" name="__codelineno-22-31" href="#__codelineno-22-31"></a>            }
<a id="__codelineno-22-32" name="__codelineno-22-32" href="#__codelineno-22-32"></a>        }
<a id="__codelineno-22-33" name="__codelineno-22-33" href="#__codelineno-22-33"></a>
<a id="__codelineno-22-34" name="__codelineno-22-34" href="#__codelineno-22-34"></a>        then {
<a id="__codelineno-22-35" name="__codelineno-22-35" href="#__codelineno-22-35"></a>            assert process.success
<a id="__codelineno-22-36" name="__codelineno-22-36" href="#__codelineno-22-36"></a>            assert snapshot(process.out).match()
<a id="__codelineno-22-37" name="__codelineno-22-37" href="#__codelineno-22-37"></a>        }
<a id="__codelineno-22-38" name="__codelineno-22-38" href="#__codelineno-22-38"></a>
<a id="__codelineno-22-39" name="__codelineno-22-39" href="#__codelineno-22-39"></a>    }
</code></pre></div>
<p>Then you can run the test again:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a>nf-test<span class="w"> </span><span class="nb">test</span><span class="w"> </span>modules/samtools/index/tests/main.nf.test
</code></pre></div>
<p>This produces:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">modules/samtools/index/tests/main.nf.test</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-24-27">27</a></span>
<span class="normal"><a href="#__codelineno-24-28">28</a></span>
<span class="normal"><a href="#__codelineno-24-29">29</a></span>
<span class="normal"><a href="#__codelineno-24-30">30</a></span>
<span class="normal"><a href="#__codelineno-24-31">31</a></span>
<span class="normal"><a href="#__codelineno-24-32">32</a></span>
<span class="normal"><a href="#__codelineno-24-33">33</a></span>
<span class="normal"><a href="#__codelineno-24-34">34</a></span>
<span class="normal"><a href="#__codelineno-24-35">35</a></span>
<span class="normal"><a href="#__codelineno-24-36">36</a></span>
<span class="normal"><a href="#__codelineno-24-37">37</a></span>
<span class="normal"><a href="#__codelineno-24-38">38</a></span>
<span class="normal"><a href="#__codelineno-24-39">39</a></span>
<span class="normal"><a href="#__codelineno-24-40">40</a></span>
<span class="normal"><a href="#__codelineno-24-41">41</a></span>
<span class="normal"><a href="#__codelineno-24-42">42</a></span>
<span class="normal"><a href="#__codelineno-24-43">43</a></span>
<span class="normal"><a href="#__codelineno-24-44">44</a></span>
<span class="normal"><a href="#__codelineno-24-45">45</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-24-27" name="__codelineno-24-27"></a><span class="err">🚀</span><span class="w"> </span><span class="n">nf</span><span class="o">-</span><span class="n">test</span><span class="w"> </span><span class="mf">0.9</span><span class="o">.</span><span class="mi">2</span>
<a id="__codelineno-24-28" name="__codelineno-24-28"></a><span class="nl">https:</span><span class="c1">//www.nf-test.com</span>
<a id="__codelineno-24-29" name="__codelineno-24-29"></a><span class="o">(</span><span class="n">c</span><span class="o">)</span><span class="w"> </span><span class="mi">2021</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2024</span><span class="w"> </span><span class="n">Lukas</span><span class="w"> </span><span class="n">Forer</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">Sebastian</span><span class="w"> </span><span class="n">Schoenherr</span>
<a id="__codelineno-24-30" name="__codelineno-24-30"></a>
<a id="__codelineno-24-31" name="__codelineno-24-31"></a><span class="nl">Warning:</span><span class="w"> </span><span class="n">every</span><span class="w"> </span><span class="n">snapshot</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">fails</span><span class="w"> </span><span class="n">during</span><span class="w"> </span><span class="k">this</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">re</span><span class="o">-</span><span class="n">record</span><span class="o">.</span>
<a id="__codelineno-24-32" name="__codelineno-24-32"></a>
<a id="__codelineno-24-33" name="__codelineno-24-33"></a><span class="n">Test</span><span class="w"> </span><span class="n">Process</span><span class="w"> </span><span class="n">SAMTOOLS_INDEX</span>
<a id="__codelineno-24-34" name="__codelineno-24-34"></a>
<a id="__codelineno-24-35" name="__codelineno-24-35"></a><span class="w">  </span><span class="n">Test</span><span class="w"> </span><span class="o">[</span><span class="mi">625</span><span class="n">e39ee</span><span class="o">]</span><span class="w"> </span><span class="s1">&#39;Should index reads_son.bam correctly&#39;</span><span class="w"> </span><span class="n">PASSED</span><span class="w"> </span><span class="o">(</span><span class="mf">10.916</span><span class="n">s</span><span class="o">)</span>
<a id="__codelineno-24-36" name="__codelineno-24-36"></a><span class="w">  </span><span class="n">Test</span><span class="w"> </span><span class="o">[</span><span class="n">a8b28f36</span><span class="o">]</span><span class="w"> </span><span class="s1">&#39;Should index reads_mother.bam correctly&#39;</span><span class="w"> </span><span class="n">PASSED</span><span class="w"> </span><span class="o">(</span><span class="mf">11.147</span><span class="n">s</span><span class="o">)</span>
<a id="__codelineno-24-37" name="__codelineno-24-37"></a><span class="w">  </span><span class="n">Test</span><span class="w"> </span><span class="o">[</span><span class="n">c15852a1</span><span class="o">]</span><span class="w"> </span><span class="s1">&#39;Should index reads_father.bam correctly&#39;</span><span class="w"> </span><span class="n">PASSED</span><span class="w"> </span><span class="o">(</span><span class="mf">10.785</span><span class="n">s</span><span class="o">)</span>
<a id="__codelineno-24-38" name="__codelineno-24-38"></a><span class="w">  </span><span class="nl">Snapshots:</span>
<a id="__codelineno-24-39" name="__codelineno-24-39"></a><span class="w">    </span><span class="mi">2</span><span class="w"> </span><span class="n">created</span><span class="w"> </span><span class="o">[</span><span class="n">Should</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="n">reads_father</span><span class="o">.</span><span class="na">bam</span><span class="w"> </span><span class="n">correctly</span><span class="o">,</span><span class="w"> </span><span class="n">Should</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="n">reads_mother</span><span class="o">.</span><span class="na">bam</span><span class="w"> </span><span class="n">correctly</span><span class="o">]</span>
<a id="__codelineno-24-40" name="__codelineno-24-40"></a>
<a id="__codelineno-24-41" name="__codelineno-24-41"></a>
<a id="__codelineno-24-42" name="__codelineno-24-42"></a><span class="n">Snapshot</span><span class="w"> </span><span class="nl">Summary:</span>
<a id="__codelineno-24-43" name="__codelineno-24-43"></a><span class="w">  </span><span class="mi">2</span><span class="w"> </span><span class="n">created</span>
<a id="__codelineno-24-44" name="__codelineno-24-44"></a>
<a id="__codelineno-24-45" name="__codelineno-24-45"></a><span class="nl">SUCCESS:</span><span class="w"> </span><span class="n">Executed</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="n">tests</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mf">32.913</span><span class="n">s</span>
</code></pre></div></td></tr></table></div>
<p>Notice the warning, referring to the effect of the <code>--update-snapshot</code> parameter.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Here we are using test data that we used previously to demonstrate the scientific outputs of the pipeline.
If we had been planning to operate these tests in a production environment, we would have generated smaller inputs for testing purposes.</p>
<p>In general it's important to keep unit tests as light as possible by using the smallest pieces of data necessary and sufficient for evaluating process functionality, otherwise the total runtime can add up quite seriously.
A test suite that takes too long to run regularly is a test suite that's likely to get skipped in the interest of expediency.</p>
</div>
<h3 id="takeaway_1">Takeaway<a class="headerlink" href="#takeaway_1" title="Permanent link">&para;</a></h3>
<p>You've written your first module test for a genomics process, verifying that <code>SAMTOOLS_INDEX</code> correctly creates index files for different BAM files. The test suite ensures that:</p>
<ol>
<li>The process runs successfully</li>
<li>Index files are created</li>
<li>The outputs are consistent across runs</li>
<li>The process works for all sample BAM files</li>
</ol>
<h3 id="whats-next_1">What's next?<a class="headerlink" href="#whats-next_1" title="Permanent link">&para;</a></h3>
<p>Learn how to write tests for other processes in our genomics workflow, using the setup method to handle chained processes. We'll also evaluate whether outputs, specifically our VCF files, contain expected variant calls.</p>
<hr />
<h2 id="2-add-tests-to-a-chained-process-and-test-for-contents">2. Add tests to a chained process and test for contents<a class="headerlink" href="#2-add-tests-to-a-chained-process-and-test-for-contents" title="Permanent link">&para;</a></h2>
<p>To test <code>GATK_HAPLOTYPECALLER</code>, we need to provide the process with the <code>SAMTOOLS_INDEX</code> output as an input. We could do that by running <code>SAMTOOLS_INDEX</code>, retrieving its outputs, and storing them with the test data for the workflow. That's actually the recommended approach for a polished pipeline, but nf-test provides an alternative approach, using the <code>setup</code> method.</p>
<p>With the setup method, we can trigger the <code>SAMTOOLS_INDEX</code> process as part of the test setup, and then use its output as an input for <code>GATK_HAPLOTYPECALLER</code>. This has a cost - we're going to have to run the <code>SAMTOOLS_INDEX</code> process every time we run the test for <code>GATK_HAPLOTYPECALLER</code>- but maybe we're still developing the workflow and don't want to pre-generate test data we might have to change later. <code>SAMTOOLS_INDEX</code> process is also very quick, so maybe the benefits of pre-generating and storing its outputs are negligible. Let's see the setup method works.</p>
<h3 id="21-generate-and-place-the-test-file">2.1. Generate and place the test file<a class="headerlink" href="#21-generate-and-place-the-test-file" title="Permanent link">&para;</a></h3>
<p>As previously, first we generate the file stub:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>nf-test<span class="w"> </span>generate<span class="w"> </span>process<span class="w"> </span>modules/gatk/haplotypecaller/main.nf
</code></pre></div>
<p>This produces the following test stub:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">tests/modules/gatk/haplotypecaller/main.nf.test</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-26-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-26-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-26-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-26-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-26-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-26-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-26-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-26-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-26-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-26-10">10</a></span>
<span class="normal"><a href="#__codelineno-26-11">11</a></span>
<span class="normal"><a href="#__codelineno-26-12">12</a></span>
<span class="normal"><a href="#__codelineno-26-13">13</a></span>
<span class="normal"><a href="#__codelineno-26-14">14</a></span>
<span class="normal"><a href="#__codelineno-26-15">15</a></span>
<span class="normal"><a href="#__codelineno-26-16">16</a></span>
<span class="normal"><a href="#__codelineno-26-17">17</a></span>
<span class="normal"><a href="#__codelineno-26-18">18</a></span>
<span class="normal"><a href="#__codelineno-26-19">19</a></span>
<span class="normal"><a href="#__codelineno-26-20">20</a></span>
<span class="normal"><a href="#__codelineno-26-21">21</a></span>
<span class="normal"><a href="#__codelineno-26-22">22</a></span>
<span class="normal"><a href="#__codelineno-26-23">23</a></span>
<span class="normal"><a href="#__codelineno-26-24">24</a></span>
<span class="normal"><a href="#__codelineno-26-25">25</a></span>
<span class="normal"><a href="#__codelineno-26-26">26</a></span>
<span class="normal"><a href="#__codelineno-26-27">27</a></span>
<span class="normal"><a href="#__codelineno-26-28">28</a></span>
<span class="normal"><a href="#__codelineno-26-29">29</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1"></a><span class="n">nextflow_process</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-26-2" name="__codelineno-26-2"></a>
<a id="__codelineno-26-3" name="__codelineno-26-3"></a><span class="w">    </span><span class="n">name</span><span class="w"> </span><span class="s2">&quot;Test Process GATK_HAPLOTYPECALLER&quot;</span>
<a id="__codelineno-26-4" name="__codelineno-26-4"></a><span class="w">    </span><span class="n">script</span><span class="w"> </span><span class="s2">&quot;modules/gatk/haplotypecaller/main.nf&quot;</span>
<a id="__codelineno-26-5" name="__codelineno-26-5"></a><span class="w">    </span><span class="n">process</span><span class="w"> </span><span class="s2">&quot;GATK_HAPLOTYPECALLER&quot;</span>
<a id="__codelineno-26-6" name="__codelineno-26-6"></a>
<a id="__codelineno-26-7" name="__codelineno-26-7"></a><span class="w">    </span><span class="n">test</span><span class="o">(</span><span class="s2">&quot;Should run without failures&quot;</span><span class="o">)</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-26-8" name="__codelineno-26-8"></a>
<a id="__codelineno-26-9" name="__codelineno-26-9"></a><span class="w">        </span><span class="n">when</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-26-10" name="__codelineno-26-10"></a><span class="w">            </span><span class="n">params</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-26-11" name="__codelineno-26-11"></a><span class="w">                </span><span class="c1">// define parameters here. Example:</span>
<a id="__codelineno-26-12" name="__codelineno-26-12"></a><span class="w">                </span><span class="c1">// outdir = &quot;tests/results&quot;</span>
<a id="__codelineno-26-13" name="__codelineno-26-13"></a><span class="w">            </span><span class="o">}</span>
<a id="__codelineno-26-14" name="__codelineno-26-14"></a><span class="w">            </span><span class="n">process</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-26-15" name="__codelineno-26-15"></a><span class="w">                </span><span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-26-16" name="__codelineno-26-16"></a><span class="s2">                // define inputs of the process here. Example:</span>
<a id="__codelineno-26-17" name="__codelineno-26-17"></a><span class="s2">                // input[0] = file(&quot;test-file.txt&quot;)</span>
<a id="__codelineno-26-18" name="__codelineno-26-18"></a><span class="s2">                &quot;&quot;&quot;</span>
<a id="__codelineno-26-19" name="__codelineno-26-19"></a><span class="w">            </span><span class="o">}</span>
<a id="__codelineno-26-20" name="__codelineno-26-20"></a><span class="w">        </span><span class="o">}</span>
<a id="__codelineno-26-21" name="__codelineno-26-21"></a>
<a id="__codelineno-26-22" name="__codelineno-26-22"></a><span class="w">        </span><span class="n">then</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-26-23" name="__codelineno-26-23"></a><span class="w">            </span><span class="k">assert</span><span class="w"> </span><span class="n">process</span><span class="o">.</span><span class="na">success</span>
<a id="__codelineno-26-24" name="__codelineno-26-24"></a><span class="w">            </span><span class="k">assert</span><span class="w"> </span><span class="n">snapshot</span><span class="o">(</span><span class="n">process</span><span class="o">.</span><span class="na">out</span><span class="o">).</span><span class="na">match</span><span class="o">()</span>
<a id="__codelineno-26-25" name="__codelineno-26-25"></a><span class="w">        </span><span class="o">}</span>
<a id="__codelineno-26-26" name="__codelineno-26-26"></a>
<a id="__codelineno-26-27" name="__codelineno-26-27"></a><span class="w">    </span><span class="o">}</span>
<a id="__codelineno-26-28" name="__codelineno-26-28"></a>
<a id="__codelineno-26-29" name="__codelineno-26-29"></a><span class="o">}</span>
</code></pre></div></td></tr></table></div>
<h3 id="22-move-the-test-file-and-update-the-script-path">2.2. Move the test file and update the script path<a class="headerlink" href="#22-move-the-test-file-and-update-the-script-path" title="Permanent link">&para;</a></h3>
<p>We create a directory for the test file co-located with the module's <code>main.nf</code> file:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a>mkdir<span class="w"> </span>-p<span class="w"> </span>modules/gatk/haplotypecaller/tests
</code></pre></div>
<p>And move the test stub file there:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a>mv<span class="w"> </span>tests/modules/gatk/haplotypecaller/main.nf.test<span class="w"> </span>modules/gatk/haplotypecaller/tests/
</code></pre></div>
<p>Finally, don't forget to update the script path:</p>
<p><em>Before:</em></p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">modules/gatk/haplotypecaller/tests/main.nf.test</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-29-3">3</a></span>
<span class="normal"><a href="#__codelineno-29-4">4</a></span>
<span class="normal"><a href="#__codelineno-29-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-29-3" name="__codelineno-29-3"></a><span class="w">    </span><span class="n">name</span><span class="w"> </span><span class="s2">&quot;Test Process GATK_HAPLOTYPECALLER&quot;</span>
<a id="__codelineno-29-4" name="__codelineno-29-4"></a><span class="hll"><span class="w">    </span><span class="n">script</span><span class="w"> </span><span class="s2">&quot;modules/gatk/haplotypecaller/main.nf&quot;</span>
</span><a id="__codelineno-29-5" name="__codelineno-29-5"></a><span class="w">    </span><span class="n">process</span><span class="w"> </span><span class="s2">&quot;GATK_HAPLOTYPECALLER&quot;</span>
</code></pre></div></td></tr></table></div>
<p><em>After:</em></p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">modules/gatk/haplotypecaller/tests/main.nf.test</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-30-3">3</a></span>
<span class="normal"><a href="#__codelineno-30-4">4</a></span>
<span class="normal"><a href="#__codelineno-30-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-30-3" name="__codelineno-30-3"></a><span class="w">    </span><span class="n">name</span><span class="w"> </span><span class="s2">&quot;Test Process GATK_HAPLOTYPECALLER&quot;</span>
<a id="__codelineno-30-4" name="__codelineno-30-4"></a><span class="hll"><span class="w">    </span><span class="n">script</span><span class="w"> </span><span class="s2">&quot;../main.nf&quot;</span>
</span><a id="__codelineno-30-5" name="__codelineno-30-5"></a><span class="w">    </span><span class="n">process</span><span class="w"> </span><span class="s2">&quot;GATK_HAPLOTYPECALLER&quot;</span>
</code></pre></div></td></tr></table></div>
<h3 id="23-provide-inputs-using-the-setup-method">2.3. Provide inputs using the setup method<a class="headerlink" href="#23-provide-inputs-using-the-setup-method" title="Permanent link">&para;</a></h3>
<p>We insert a <code>setup</code> block before the <code>when</code> block, where we can trigger a run of the <code>SAMTOOLS_INDEX</code> process on one of our original input files. Also, remember as before to change the test name to something meaningful.</p>
<p><em>Before:</em></p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">modules/gatk/haplotypecaller/tests/main.nf.test</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-31-7">7</a></span>
<span class="normal"><a href="#__codelineno-31-8">8</a></span>
<span class="normal"><a href="#__codelineno-31-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-31-7" name="__codelineno-31-7"></a><span class="hll"><span class="n">test</span><span class="o">(</span><span class="s2">&quot;Should run without failures&quot;</span><span class="o">)</span><span class="w"> </span><span class="o">{</span>
</span><a id="__codelineno-31-8" name="__codelineno-31-8"></a>
<a id="__codelineno-31-9" name="__codelineno-31-9"></a><span class="w">    </span><span class="n">when</span><span class="w"> </span><span class="o">{</span>
</code></pre></div></td></tr></table></div>
<p><em>After:</em></p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">modules/gatk/haplotypecaller/tests/main.nf.test</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-32-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-32-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-32-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-32-10">10</a></span>
<span class="normal"><a href="#__codelineno-32-11">11</a></span>
<span class="normal"><a href="#__codelineno-32-12">12</a></span>
<span class="normal"><a href="#__codelineno-32-13">13</a></span>
<span class="normal"><a href="#__codelineno-32-14">14</a></span>
<span class="normal"><a href="#__codelineno-32-15">15</a></span>
<span class="normal"><a href="#__codelineno-32-16">16</a></span>
<span class="normal"><a href="#__codelineno-32-17">17</a></span>
<span class="normal"><a href="#__codelineno-32-18">18</a></span>
<span class="normal"><a href="#__codelineno-32-19">19</a></span>
<span class="normal"><a href="#__codelineno-32-20">20</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-32-7" name="__codelineno-32-7"></a><span class="hll"><span class="w">    </span><span class="n">test</span><span class="o">(</span><span class="s2">&quot;Should call son&#39;s haplotype correctly&quot;</span><span class="o">)</span><span class="w"> </span><span class="o">{</span>
</span><a id="__codelineno-32-8" name="__codelineno-32-8"></a><span class="hll">
</span><a id="__codelineno-32-9" name="__codelineno-32-9"></a><span class="hll"><span class="w">        </span><span class="n">setup</span><span class="w"> </span><span class="o">{</span>
</span><a id="__codelineno-32-10" name="__codelineno-32-10"></a><span class="hll"><span class="w">            </span><span class="n">run</span><span class="o">(</span><span class="s2">&quot;SAMTOOLS_INDEX&quot;</span><span class="o">)</span><span class="w"> </span><span class="o">{</span>
</span><a id="__codelineno-32-11" name="__codelineno-32-11"></a><span class="hll"><span class="w">                </span><span class="n">script</span><span class="w"> </span><span class="s2">&quot;../../../samtools/index/main.nf&quot;</span>
</span><a id="__codelineno-32-12" name="__codelineno-32-12"></a><span class="hll"><span class="w">                </span><span class="n">process</span><span class="w"> </span><span class="o">{</span>
</span><a id="__codelineno-32-13" name="__codelineno-32-13"></a><span class="hll"><span class="w">                    </span><span class="s2">&quot;&quot;&quot;</span>
</span><a id="__codelineno-32-14" name="__codelineno-32-14"></a><span class="hll"><span class="s2">                    input[0] =  file(&quot;${projectDir}/data/bam/reads_son.bam&quot;)</span>
</span><a id="__codelineno-32-15" name="__codelineno-32-15"></a><span class="hll"><span class="s2">                    &quot;&quot;&quot;</span>
</span><a id="__codelineno-32-16" name="__codelineno-32-16"></a><span class="hll"><span class="w">                </span><span class="o">}</span>
</span><a id="__codelineno-32-17" name="__codelineno-32-17"></a><span class="hll"><span class="w">            </span><span class="o">}</span>
</span><a id="__codelineno-32-18" name="__codelineno-32-18"></a><span class="hll"><span class="w">        </span><span class="o">}</span>
</span><a id="__codelineno-32-19" name="__codelineno-32-19"></a>
<a id="__codelineno-32-20" name="__codelineno-32-20"></a><span class="w">        </span><span class="n">when</span><span class="w"> </span><span class="o">{</span>
</code></pre></div></td></tr></table></div>
<p>Then we can refer to the output of that process in the <code>when</code> block where we specify the test inputs:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">modules/gatk/haplotypecaller/tests/main.nf.test</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-33-20">20</a></span>
<span class="normal"><a href="#__codelineno-33-21">21</a></span>
<span class="normal"><a href="#__codelineno-33-22">22</a></span>
<span class="normal"><a href="#__codelineno-33-23">23</a></span>
<span class="normal"><a href="#__codelineno-33-24">24</a></span>
<span class="normal"><a href="#__codelineno-33-25">25</a></span>
<span class="normal"><a href="#__codelineno-33-26">26</a></span>
<span class="normal"><a href="#__codelineno-33-27">27</a></span>
<span class="normal"><a href="#__codelineno-33-28">28</a></span>
<span class="normal"><a href="#__codelineno-33-29">29</a></span>
<span class="normal"><a href="#__codelineno-33-30">30</a></span>
<span class="normal"><a href="#__codelineno-33-31">31</a></span>
<span class="normal"><a href="#__codelineno-33-32">32</a></span>
<span class="normal"><a href="#__codelineno-33-33">33</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-33-20" name="__codelineno-33-20"></a><span class="w">        </span><span class="n">when</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-33-21" name="__codelineno-33-21"></a><span class="w">            </span><span class="n">params</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-33-22" name="__codelineno-33-22"></a><span class="w">                </span><span class="n">outdir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;tests/results&quot;</span>
<a id="__codelineno-33-23" name="__codelineno-33-23"></a><span class="w">            </span><span class="o">}</span>
<a id="__codelineno-33-24" name="__codelineno-33-24"></a><span class="w">            </span><span class="n">process</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-33-25" name="__codelineno-33-25"></a><span class="w">                </span><span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-33-26" name="__codelineno-33-26"></a><span class="s2">                input[0] = SAMTOOLS_INDEX.out</span>
<a id="__codelineno-33-27" name="__codelineno-33-27"></a><span class="s2">                input[1] = file(&quot;${projectDir}/data/ref/ref.fasta&quot;)</span>
<a id="__codelineno-33-28" name="__codelineno-33-28"></a><span class="s2">                input[2] = file(&quot;${projectDir}/data/ref/ref.fasta.fai&quot;)</span>
<a id="__codelineno-33-29" name="__codelineno-33-29"></a><span class="s2">                input[3] = file(&quot;${projectDir}/data/ref/ref.dict&quot;)</span>
<a id="__codelineno-33-30" name="__codelineno-33-30"></a><span class="s2">                input[4] = file(&quot;${projectDir}/data/ref/intervals.bed&quot;)</span>
<a id="__codelineno-33-31" name="__codelineno-33-31"></a><span class="s2">                &quot;&quot;&quot;</span>
<a id="__codelineno-33-32" name="__codelineno-33-32"></a><span class="w">            </span><span class="o">}</span>
<a id="__codelineno-33-33" name="__codelineno-33-33"></a><span class="w">        </span><span class="o">}</span>
</code></pre></div></td></tr></table></div>
<p>Make that change and run the test again:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a>nf-test<span class="w"> </span><span class="nb">test</span><span class="w"> </span>modules/gatk/haplotypecaller/tests/main.nf.test
</code></pre></div>
<p>This produces the following output:</p>
<div class="highlight"><span class="filename">Output</span><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a><span class="go">🚀 nf-test 0.9.2</span>
<a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a><span class="go">https://www.nf-test.com</span>
<a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a><span class="gp gp-VirtualEnv">(c)</span> <span class="go">2021 - 2024 Lukas Forer and Sebastian Schoenherr</span>
<a id="__codelineno-35-4" name="__codelineno-35-4" href="#__codelineno-35-4"></a>
<a id="__codelineno-35-5" name="__codelineno-35-5" href="#__codelineno-35-5"></a>
<a id="__codelineno-35-6" name="__codelineno-35-6" href="#__codelineno-35-6"></a><span class="go">Test Process GATK_HAPLOTYPECALLER</span>
<a id="__codelineno-35-7" name="__codelineno-35-7" href="#__codelineno-35-7"></a>
<a id="__codelineno-35-8" name="__codelineno-35-8" href="#__codelineno-35-8"></a><span class="go">  Test [30247349] &#39;Should call son&#39;s haplotype correctly&#39; PASSED (20.002s)</span>
<a id="__codelineno-35-9" name="__codelineno-35-9" href="#__codelineno-35-9"></a><span class="go">  Snapshots:</span>
<a id="__codelineno-35-10" name="__codelineno-35-10" href="#__codelineno-35-10"></a><span class="go">    1 created [Should call son&#39;s haplotype correctly]</span>
<a id="__codelineno-35-11" name="__codelineno-35-11" href="#__codelineno-35-11"></a>
<a id="__codelineno-35-12" name="__codelineno-35-12" href="#__codelineno-35-12"></a>
<a id="__codelineno-35-13" name="__codelineno-35-13" href="#__codelineno-35-13"></a><span class="go">Snapshot Summary:</span>
<a id="__codelineno-35-14" name="__codelineno-35-14" href="#__codelineno-35-14"></a><span class="go">  1 created</span>
<a id="__codelineno-35-15" name="__codelineno-35-15" href="#__codelineno-35-15"></a>
<a id="__codelineno-35-16" name="__codelineno-35-16" href="#__codelineno-35-16"></a><span class="go">SUCCESS: Executed 1 tests in 20.027s</span>
</code></pre></div>
<p>It also produces a snapshot file like earlier.</p>
<h3 id="24-run-again-and-observe-failure">2.4. Run again and observe failure<a class="headerlink" href="#24-run-again-and-observe-failure" title="Permanent link">&para;</a></h3>
<p>Interestingly, if you run the exact same command again, this time the test will fail. This command:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a>nf-test<span class="w"> </span><span class="nb">test</span><span class="w"> </span>modules/gatk/haplotypecaller/tests/main.nf.test
</code></pre></div>
<p>produces:</p>
<div class="highlight"><span class="filename">Output</span><pre><span></span><code><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a><span class="go">🚀 nf-test 0.9.2</span>
<a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a><span class="go">https://www.nf-test.com</span>
<a id="__codelineno-37-3" name="__codelineno-37-3" href="#__codelineno-37-3"></a><span class="gp gp-VirtualEnv">(c)</span> <span class="go">2021 - 2024 Lukas Forer and Sebastian Schoenherr</span>
<a id="__codelineno-37-4" name="__codelineno-37-4" href="#__codelineno-37-4"></a>
<a id="__codelineno-37-5" name="__codelineno-37-5" href="#__codelineno-37-5"></a>
<a id="__codelineno-37-6" name="__codelineno-37-6" href="#__codelineno-37-6"></a><span class="go">Test Process GATK_HAPLOTYPECALLER</span>
<a id="__codelineno-37-7" name="__codelineno-37-7" href="#__codelineno-37-7"></a>
<a id="__codelineno-37-8" name="__codelineno-37-8" href="#__codelineno-37-8"></a><span class="go">  Test [c847bfae] &#39;Should call son&#39;s haplotype correctly&#39; FAILED (19.979s)</span>
<a id="__codelineno-37-9" name="__codelineno-37-9" href="#__codelineno-37-9"></a>
<a id="__codelineno-37-10" name="__codelineno-37-10" href="#__codelineno-37-10"></a><span class="go">  java.lang.RuntimeException: Different Snapshot:</span>
<a id="__codelineno-37-11" name="__codelineno-37-11" href="#__codelineno-37-11"></a><span class="go">  [                                                                                           [</span>
<a id="__codelineno-37-12" name="__codelineno-37-12" href="#__codelineno-37-12"></a><span class="go">      {                                                                                           {</span>
<a id="__codelineno-37-13" name="__codelineno-37-13" href="#__codelineno-37-13"></a><span class="go">          &quot;0&quot;: [                                                                                      &quot;0&quot;: [</span>
<a id="__codelineno-37-14" name="__codelineno-37-14" href="#__codelineno-37-14"></a><span class="go">              &quot;reads_son.bam.g.vcf:md5,069316cdd4328542ffc6ae247b1dac39&quot;                         |                 &quot;reads_son.bam.g.vcf:md5,005f1a13ee39f11b0fc9bea094850eac&quot;</span>
<a id="__codelineno-37-15" name="__codelineno-37-15" href="#__codelineno-37-15"></a><span class="go">          ],                                                                                          ],</span>
<a id="__codelineno-37-16" name="__codelineno-37-16" href="#__codelineno-37-16"></a><span class="go">          &quot;1&quot;: [                                                                                      &quot;1&quot;: [</span>
<a id="__codelineno-37-17" name="__codelineno-37-17" href="#__codelineno-37-17"></a><span class="go">              &quot;reads_son.bam.g.vcf.idx:md5,dc36c18f2afdc546f41e68b2687e9334&quot;                     |                 &quot;reads_son.bam.g.vcf.idx:md5,dbad4b76a4b90c158ffc9c9740764242&quot;</span>
<a id="__codelineno-37-18" name="__codelineno-37-18" href="#__codelineno-37-18"></a><span class="go">          ],                                                                                          ],</span>
<a id="__codelineno-37-19" name="__codelineno-37-19" href="#__codelineno-37-19"></a><span class="go">          &quot;idx&quot;: [                                                                                    &quot;idx&quot;: [</span>
<a id="__codelineno-37-20" name="__codelineno-37-20" href="#__codelineno-37-20"></a><span class="go">              &quot;reads_son.bam.g.vcf.idx:md5,dc36c18f2afdc546f41e68b2687e9334&quot;                     |                 &quot;reads_son.bam.g.vcf.idx:md5,dbad4b76a4b90c158ffc9c9740764242&quot;</span>
<a id="__codelineno-37-21" name="__codelineno-37-21" href="#__codelineno-37-21"></a><span class="go">          ],                                                                                          ],</span>
<a id="__codelineno-37-22" name="__codelineno-37-22" href="#__codelineno-37-22"></a><span class="go">          &quot;vcf&quot;: [                                                                                    &quot;vcf&quot;: [</span>
<a id="__codelineno-37-23" name="__codelineno-37-23" href="#__codelineno-37-23"></a><span class="go">              &quot;reads_son.bam.g.vcf:md5,069316cdd4328542ffc6ae247b1dac39&quot;                         |                 &quot;reads_son.bam.g.vcf:md5,005f1a13ee39f11b0fc9bea094850eac&quot;</span>
<a id="__codelineno-37-24" name="__codelineno-37-24" href="#__codelineno-37-24"></a><span class="go">          ]                                                                                           ]</span>
<a id="__codelineno-37-25" name="__codelineno-37-25" href="#__codelineno-37-25"></a><span class="go">      }                                                                                           }</span>
<a id="__codelineno-37-26" name="__codelineno-37-26" href="#__codelineno-37-26"></a><span class="go">  ]                                                                                           ]</span>
<a id="__codelineno-37-27" name="__codelineno-37-27" href="#__codelineno-37-27"></a>
<a id="__codelineno-37-28" name="__codelineno-37-28" href="#__codelineno-37-28"></a><span class="go">  Nextflow stdout:</span>
<a id="__codelineno-37-29" name="__codelineno-37-29" href="#__codelineno-37-29"></a>
<a id="__codelineno-37-30" name="__codelineno-37-30" href="#__codelineno-37-30"></a><span class="go">  Nextflow stderr:</span>
<a id="__codelineno-37-31" name="__codelineno-37-31" href="#__codelineno-37-31"></a>
<a id="__codelineno-37-32" name="__codelineno-37-32" href="#__codelineno-37-32"></a>
<a id="__codelineno-37-33" name="__codelineno-37-33" href="#__codelineno-37-33"></a><span class="go">    Obsolete snapshots can only be checked if all tests of a file are executed successful.</span>
<a id="__codelineno-37-34" name="__codelineno-37-34" href="#__codelineno-37-34"></a>
<a id="__codelineno-37-35" name="__codelineno-37-35" href="#__codelineno-37-35"></a>
<a id="__codelineno-37-36" name="__codelineno-37-36" href="#__codelineno-37-36"></a><span class="go">FAILURE: Executed 1 tests in 20.032s (1 failed)</span>
</code></pre></div>
<p>The error message tells you there were differences between the snapshots for the two runs; specifically, the md5sum values are different for the VCF files.</p>
<p>Why? To make a long story short, the HaplotypeCaller tool includes a timestamp in the VCF header that is different every time (by definition).
As a result, we can't just expect the files to have identical md5sums even if they have identical content in terms of the variant calls themselves.</p>
<p>How do we deal with that?</p>
<h3 id="25-use-a-content-assertion-method-to-check-a-specific-variant">2.5. Use a content assertion method to check a specific variant<a class="headerlink" href="#25-use-a-content-assertion-method-to-check-a-specific-variant" title="Permanent link">&para;</a></h3>
<p>One way to solve the problem is to use a <a href="https://nf-co.re/docs/contributing/tutorials/nf-test_assertions">different kind of assertion</a>.
In this case, we're going to check for specific content instead of asserting identity.
More exactly, we'll have the tool read the lines of the VCF file and check for the existence of specific lines.</p>
<p>In practice, we replace the second assertion in the <code>then</code> block as follows:</p>
<p><em>Before:</em></p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">modules/gatk/haplotypecaller/tests/main.nf.test</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-38-35">35</a></span>
<span class="normal"><a href="#__codelineno-38-36">36</a></span>
<span class="normal"><a href="#__codelineno-38-37">37</a></span>
<span class="normal"><a href="#__codelineno-38-38">38</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-38-35" name="__codelineno-38-35"></a><span class="n">then</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-38-36" name="__codelineno-38-36"></a><span class="w">    </span><span class="k">assert</span><span class="w"> </span><span class="n">process</span><span class="o">.</span><span class="na">success</span>
<a id="__codelineno-38-37" name="__codelineno-38-37"></a><span class="hll"><span class="w">    </span><span class="k">assert</span><span class="w"> </span><span class="n">snapshot</span><span class="o">(</span><span class="n">process</span><span class="o">.</span><span class="na">out</span><span class="o">).</span><span class="na">match</span><span class="o">()</span>
</span><a id="__codelineno-38-38" name="__codelineno-38-38"></a><span class="o">}</span>
</code></pre></div></td></tr></table></div>
<p><em>After:</em></p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">modules/gatk/haplotypecaller/tests/main.nf.test</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-39-35">35</a></span>
<span class="normal"><a href="#__codelineno-39-36">36</a></span>
<span class="normal"><a href="#__codelineno-39-37">37</a></span>
<span class="normal"><a href="#__codelineno-39-38">38</a></span>
<span class="normal"><a href="#__codelineno-39-39">39</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-39-35" name="__codelineno-39-35"></a><span class="go">        then {</span>
<a id="__codelineno-39-36" name="__codelineno-39-36"></a><span class="go">            assert process.success</span>
<a id="__codelineno-39-37" name="__codelineno-39-37"></a><span class="hll"><span class="go">            assert path(process.out[0][0]).readLines().contains(&#39;#CHROM	POS	ID	REF	ALT	QUAL	FILTER	INFO	FORMAT	reads_son&#39;)</span>
</span><a id="__codelineno-39-38" name="__codelineno-39-38"></a><span class="hll"><span class="go">            assert path(process.out[0][0]).readLines().contains(&#39;20_10037292_10066351	3277	.	G	&lt;NON_REF&gt;	.	.	END=3282	GT:DP:GQ:MIN_DP:PL	0/0:25:72:24:0,72,719&#39;)</span>
</span><a id="__codelineno-39-39" name="__codelineno-39-39"></a><span class="go">        }</span>
</code></pre></div></td></tr></table></div>
<p>Here we're reading in the full content of the VCF output file and searching for a content match, which is okay to do on a small test file, but you wouldn't want to do that on a larger file.
You might instead choose to read in specific lines.</p>
<p>This approach does require choosing more carefully what we want to use as the 'signal' to test for.
On the bright side, it can be used to test with great precision whether an analysis tool can consistently identify 'difficult' features (such as rare variants) as it undergoes further development.</p>
<h3 id="26-run-again-and-observe-success">2.6. Run again and observe success<a class="headerlink" href="#26-run-again-and-observe-success" title="Permanent link">&para;</a></h3>
<p>Once we've modified the test in this way, we can run the test multiple times, and it will consistently pass.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a>nf-test<span class="w"> </span><span class="nb">test</span><span class="w"> </span>modules/gatk/haplotypecaller/tests/main.nf.test
</code></pre></div>
<p>This produces:</p>
<div class="highlight"><span class="filename">Output</span><pre><span></span><code><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a><span class="go">🚀 nf-test 0.9.2</span>
<a id="__codelineno-41-2" name="__codelineno-41-2" href="#__codelineno-41-2"></a><span class="go">https://www.nf-test.com</span>
<a id="__codelineno-41-3" name="__codelineno-41-3" href="#__codelineno-41-3"></a><span class="gp gp-VirtualEnv">(c)</span> <span class="go">2021 - 2024 Lukas Forer and Sebastian Schoenherr</span>
<a id="__codelineno-41-4" name="__codelineno-41-4" href="#__codelineno-41-4"></a>
<a id="__codelineno-41-5" name="__codelineno-41-5" href="#__codelineno-41-5"></a>
<a id="__codelineno-41-6" name="__codelineno-41-6" href="#__codelineno-41-6"></a><span class="go">Test Process GATK_HAPLOTYPECALLER</span>
<a id="__codelineno-41-7" name="__codelineno-41-7" href="#__codelineno-41-7"></a>
<a id="__codelineno-41-8" name="__codelineno-41-8" href="#__codelineno-41-8"></a><span class="go">  Test [c847bfae] &#39;Should call son&#39;s haplotype correctly&#39; PASSED (19.33s)</span>
<a id="__codelineno-41-9" name="__codelineno-41-9" href="#__codelineno-41-9"></a>
<a id="__codelineno-41-10" name="__codelineno-41-10" href="#__codelineno-41-10"></a>
<a id="__codelineno-41-11" name="__codelineno-41-11" href="#__codelineno-41-11"></a><span class="go">SUCCESS: Executed 1 tests in 19.382s</span>
</code></pre></div>
<h3 id="27-add-more-tests">2.7. Add more tests<a class="headerlink" href="#27-add-more-tests" title="Permanent link">&para;</a></h3>
<p>Add similar tests for the mother and father samples:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">modules/gatk/haplotypecaller/tests/main.nf.test</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-42-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-42-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-42-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-42-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-42-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-42-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-42-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-42-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-42-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-42-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-42-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-42-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-42-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-42-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-42-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-42-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-42-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-42-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-42-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-42-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-42-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-42-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-42-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-42-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-42-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-42-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-42-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-42-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-42-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-42-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-42-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-42-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-42-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-42-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-42-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-42-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-42-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-42-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-42-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-42-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-42-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-42-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-42-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-42-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-42-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-42-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-42-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-42-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-42-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-42-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-42-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-42-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-42-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-42-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-42-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-42-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-42-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-42-100">100</a></span>
<span class="normal"><a href="#__codelineno-42-101">101</a></span>
<span class="normal"><a href="#__codelineno-42-102">102</a></span>
<span class="normal"><a href="#__codelineno-42-103">103</a></span>
<span class="normal"><a href="#__codelineno-42-104">104</a></span>
<span class="normal"><a href="#__codelineno-42-105">105</a></span>
<span class="normal"><a href="#__codelineno-42-106">106</a></span>
<span class="normal"><a href="#__codelineno-42-107">107</a></span>
<span class="normal"><a href="#__codelineno-42-108">108</a></span>
<span class="normal"><a href="#__codelineno-42-109">109</a></span>
<span class="normal"><a href="#__codelineno-42-110">110</a></span>
<span class="normal"><a href="#__codelineno-42-111">111</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-42-43" name="__codelineno-42-43"></a><span class="w">    </span><span class="n">test</span><span class="o">(</span><span class="s2">&quot;Should call mother&#39;s haplotype correctly&quot;</span><span class="o">)</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-42-44" name="__codelineno-42-44"></a>
<a id="__codelineno-42-45" name="__codelineno-42-45"></a><span class="w">        </span><span class="n">setup</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-42-46" name="__codelineno-42-46"></a><span class="w">            </span><span class="n">run</span><span class="o">(</span><span class="s2">&quot;SAMTOOLS_INDEX&quot;</span><span class="o">)</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-42-47" name="__codelineno-42-47"></a><span class="w">                </span><span class="n">script</span><span class="w"> </span><span class="s2">&quot;../../../samtools/index/main.nf&quot;</span>
<a id="__codelineno-42-48" name="__codelineno-42-48"></a><span class="w">                </span><span class="n">process</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-42-49" name="__codelineno-42-49"></a><span class="w">                    </span><span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-42-50" name="__codelineno-42-50"></a><span class="s2">                    input[0] =  file(&quot;${projectDir}/data/bam/reads_mother.bam&quot;)</span>
<a id="__codelineno-42-51" name="__codelineno-42-51"></a><span class="s2">                    &quot;&quot;&quot;</span>
<a id="__codelineno-42-52" name="__codelineno-42-52"></a><span class="w">                </span><span class="o">}</span>
<a id="__codelineno-42-53" name="__codelineno-42-53"></a><span class="w">            </span><span class="o">}</span>
<a id="__codelineno-42-54" name="__codelineno-42-54"></a><span class="w">        </span><span class="o">}</span>
<a id="__codelineno-42-55" name="__codelineno-42-55"></a>
<a id="__codelineno-42-56" name="__codelineno-42-56"></a><span class="w">        </span><span class="n">when</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-42-57" name="__codelineno-42-57"></a><span class="w">            </span><span class="n">params</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-42-58" name="__codelineno-42-58"></a><span class="w">                </span><span class="n">outdir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;tests/results&quot;</span>
<a id="__codelineno-42-59" name="__codelineno-42-59"></a><span class="w">            </span><span class="o">}</span>
<a id="__codelineno-42-60" name="__codelineno-42-60"></a><span class="w">            </span><span class="n">process</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-42-61" name="__codelineno-42-61"></a><span class="w">                </span><span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-42-62" name="__codelineno-42-62"></a><span class="s2">                input[0] = SAMTOOLS_INDEX.out</span>
<a id="__codelineno-42-63" name="__codelineno-42-63"></a><span class="s2">                input[1] = file(&quot;${projectDir}/data/ref/ref.fasta&quot;)</span>
<a id="__codelineno-42-64" name="__codelineno-42-64"></a><span class="s2">                input[2] = file(&quot;${projectDir}/data/ref/ref.fasta.fai&quot;)</span>
<a id="__codelineno-42-65" name="__codelineno-42-65"></a><span class="s2">                input[3] = file(&quot;${projectDir}/data/ref/ref.dict&quot;)</span>
<a id="__codelineno-42-66" name="__codelineno-42-66"></a><span class="s2">                input[4] = file(&quot;${projectDir}/data/ref/intervals.bed&quot;)</span>
<a id="__codelineno-42-67" name="__codelineno-42-67"></a><span class="s2">                &quot;&quot;&quot;</span>
<a id="__codelineno-42-68" name="__codelineno-42-68"></a><span class="w">            </span><span class="o">}</span>
<a id="__codelineno-42-69" name="__codelineno-42-69"></a><span class="w">        </span><span class="o">}</span>
<a id="__codelineno-42-70" name="__codelineno-42-70"></a>
<a id="__codelineno-42-71" name="__codelineno-42-71"></a><span class="w">        </span><span class="n">then</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-42-72" name="__codelineno-42-72"></a><span class="w">            </span><span class="k">assert</span><span class="w"> </span><span class="n">process</span><span class="o">.</span><span class="na">success</span>
<a id="__codelineno-42-73" name="__codelineno-42-73"></a><span class="w">            </span><span class="k">assert</span><span class="w"> </span><span class="n">path</span><span class="o">(</span><span class="n">process</span><span class="o">.</span><span class="na">out</span><span class="o">[</span><span class="mi">0</span><span class="o">][</span><span class="mi">0</span><span class="o">]).</span><span class="na">readLines</span><span class="o">().</span><span class="na">contains</span><span class="o">(</span><span class="s1">&#39;#CHROM	POS	ID	REF	ALT	QUAL	FILTER	INFO	FORMAT	reads_mother&#39;</span><span class="o">)</span>
<a id="__codelineno-42-74" name="__codelineno-42-74"></a><span class="w">            </span><span class="k">assert</span><span class="w"> </span><span class="n">path</span><span class="o">(</span><span class="n">process</span><span class="o">.</span><span class="na">out</span><span class="o">[</span><span class="mi">0</span><span class="o">][</span><span class="mi">0</span><span class="o">]).</span><span class="na">readLines</span><span class="o">().</span><span class="na">contains</span><span class="o">(</span><span class="s1">&#39;20_10037292_10066351	3277	.	G	&lt;NON_REF&gt;	.	.	END=3278	GT:DP:GQ:MIN_DP:PL	0/0:38:99:37:0,102,1530&#39;</span><span class="o">)</span>
<a id="__codelineno-42-75" name="__codelineno-42-75"></a><span class="w">        </span><span class="o">}</span>
<a id="__codelineno-42-76" name="__codelineno-42-76"></a><span class="w">    </span><span class="o">}</span>
<a id="__codelineno-42-77" name="__codelineno-42-77"></a>
<a id="__codelineno-42-78" name="__codelineno-42-78"></a><span class="w">    </span><span class="n">test</span><span class="o">(</span><span class="s2">&quot;Should call father&#39;s haplotype correctly&quot;</span><span class="o">)</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-42-79" name="__codelineno-42-79"></a>
<a id="__codelineno-42-80" name="__codelineno-42-80"></a><span class="w">        </span><span class="n">setup</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-42-81" name="__codelineno-42-81"></a><span class="w">            </span><span class="n">run</span><span class="o">(</span><span class="s2">&quot;SAMTOOLS_INDEX&quot;</span><span class="o">)</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-42-82" name="__codelineno-42-82"></a><span class="w">                </span><span class="n">script</span><span class="w"> </span><span class="s2">&quot;../../../samtools/index/main.nf&quot;</span>
<a id="__codelineno-42-83" name="__codelineno-42-83"></a><span class="w">                </span><span class="n">process</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-42-84" name="__codelineno-42-84"></a><span class="w">                    </span><span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-42-85" name="__codelineno-42-85"></a><span class="s2">                    input[0] =  file(&quot;${projectDir}/data/bam/reads_father.bam&quot;)</span>
<a id="__codelineno-42-86" name="__codelineno-42-86"></a><span class="s2">                    &quot;&quot;&quot;</span>
<a id="__codelineno-42-87" name="__codelineno-42-87"></a><span class="w">                </span><span class="o">}</span>
<a id="__codelineno-42-88" name="__codelineno-42-88"></a><span class="w">            </span><span class="o">}</span>
<a id="__codelineno-42-89" name="__codelineno-42-89"></a><span class="w">        </span><span class="o">}</span>
<a id="__codelineno-42-90" name="__codelineno-42-90"></a>
<a id="__codelineno-42-91" name="__codelineno-42-91"></a><span class="w">        </span><span class="n">when</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-42-92" name="__codelineno-42-92"></a><span class="w">            </span><span class="n">params</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-42-93" name="__codelineno-42-93"></a><span class="w">                </span><span class="n">outdir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;tests/results&quot;</span>
<a id="__codelineno-42-94" name="__codelineno-42-94"></a><span class="w">            </span><span class="o">}</span>
<a id="__codelineno-42-95" name="__codelineno-42-95"></a><span class="w">            </span><span class="n">process</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-42-96" name="__codelineno-42-96"></a><span class="w">                </span><span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-42-97" name="__codelineno-42-97"></a><span class="s2">                input[0] = SAMTOOLS_INDEX.out</span>
<a id="__codelineno-42-98" name="__codelineno-42-98"></a><span class="s2">                input[1] = file(&quot;${projectDir}/data/ref/ref.fasta&quot;)</span>
<a id="__codelineno-42-99" name="__codelineno-42-99"></a><span class="s2">                input[2] = file(&quot;${projectDir}/data/ref/ref.fasta.fai&quot;)</span>
<a id="__codelineno-42-100" name="__codelineno-42-100"></a><span class="s2">                input[3] = file(&quot;${projectDir}/data/ref/ref.dict&quot;)</span>
<a id="__codelineno-42-101" name="__codelineno-42-101"></a><span class="s2">                input[4] = file(&quot;${projectDir}/data/ref/intervals.bed&quot;)</span>
<a id="__codelineno-42-102" name="__codelineno-42-102"></a><span class="s2">                &quot;&quot;&quot;</span>
<a id="__codelineno-42-103" name="__codelineno-42-103"></a><span class="w">            </span><span class="o">}</span>
<a id="__codelineno-42-104" name="__codelineno-42-104"></a><span class="w">        </span><span class="o">}</span>
<a id="__codelineno-42-105" name="__codelineno-42-105"></a>
<a id="__codelineno-42-106" name="__codelineno-42-106"></a><span class="w">        </span><span class="n">then</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-42-107" name="__codelineno-42-107"></a><span class="w">            </span><span class="k">assert</span><span class="w"> </span><span class="n">process</span><span class="o">.</span><span class="na">success</span>
<a id="__codelineno-42-108" name="__codelineno-42-108"></a><span class="w">            </span><span class="k">assert</span><span class="w"> </span><span class="n">path</span><span class="o">(</span><span class="n">process</span><span class="o">.</span><span class="na">out</span><span class="o">[</span><span class="mi">0</span><span class="o">][</span><span class="mi">0</span><span class="o">]).</span><span class="na">readLines</span><span class="o">().</span><span class="na">contains</span><span class="o">(</span><span class="s1">&#39;#CHROM	POS	ID	REF	ALT	QUAL	FILTER	INFO	FORMAT	reads_father&#39;</span><span class="o">)</span>
<a id="__codelineno-42-109" name="__codelineno-42-109"></a><span class="w">            </span><span class="k">assert</span><span class="w"> </span><span class="n">path</span><span class="o">(</span><span class="n">process</span><span class="o">.</span><span class="na">out</span><span class="o">[</span><span class="mi">0</span><span class="o">][</span><span class="mi">0</span><span class="o">]).</span><span class="na">readLines</span><span class="o">().</span><span class="na">contains</span><span class="o">(</span><span class="s1">&#39;20_10037292_10066351	3277	.	G	&lt;NON_REF&gt;	.	.	END=3281	GT:DP:GQ:MIN_DP:PL	0/0:44:99:42:0,120,1800&#39;</span><span class="o">)</span>
<a id="__codelineno-42-110" name="__codelineno-42-110"></a><span class="w">        </span><span class="o">}</span>
<a id="__codelineno-42-111" name="__codelineno-42-111"></a><span class="w">    </span><span class="o">}</span>
</code></pre></div></td></tr></table></div>
<h3 id="28-run-the-test-command">2.8. Run the test command<a class="headerlink" href="#28-run-the-test-command" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a>nf-test<span class="w"> </span><span class="nb">test</span><span class="w"> </span>modules/gatk/haplotypecaller/tests/main.nf.test
</code></pre></div>
<p>This produces:</p>
<div class="highlight"><span class="filename">Output</span><pre><span></span><code><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a><span class="go">🚀 nf-test 0.9.2</span>
<a id="__codelineno-44-2" name="__codelineno-44-2" href="#__codelineno-44-2"></a><span class="go">https://www.nf-test.com</span>
<a id="__codelineno-44-3" name="__codelineno-44-3" href="#__codelineno-44-3"></a><span class="gp gp-VirtualEnv">(c)</span> <span class="go">2021 - 2024 Lukas Forer and Sebastian Schoenherr</span>
<a id="__codelineno-44-4" name="__codelineno-44-4" href="#__codelineno-44-4"></a>
<a id="__codelineno-44-5" name="__codelineno-44-5" href="#__codelineno-44-5"></a>
<a id="__codelineno-44-6" name="__codelineno-44-6" href="#__codelineno-44-6"></a><span class="go">Test Process GATK_HAPLOTYPECALLER</span>
<a id="__codelineno-44-7" name="__codelineno-44-7" href="#__codelineno-44-7"></a>
<a id="__codelineno-44-8" name="__codelineno-44-8" href="#__codelineno-44-8"></a><span class="go">  Test [c847bfae] &#39;Should call son&#39;s haplotype correctly&#39; PASSED (19.91s)</span>
<a id="__codelineno-44-9" name="__codelineno-44-9" href="#__codelineno-44-9"></a><span class="go">  Test [44494e9c] &#39;Should call mother&#39;s haplotype correctly&#39; PASSED (18.606s)</span>
<a id="__codelineno-44-10" name="__codelineno-44-10" href="#__codelineno-44-10"></a><span class="go">  Test [eb0d1a07] &#39;Should call father&#39;s haplotype correctly&#39; PASSED (18.773s)</span>
<a id="__codelineno-44-11" name="__codelineno-44-11" href="#__codelineno-44-11"></a>
<a id="__codelineno-44-12" name="__codelineno-44-12" href="#__codelineno-44-12"></a>
<a id="__codelineno-44-13" name="__codelineno-44-13" href="#__codelineno-44-13"></a><span class="go">SUCCESS: Executed 3 tests in 57.348s</span>
</code></pre></div>
<p>That completes the basic test plan for this second step in the pipeline. On to the third and last module-level test!</p>
<h3 id="takeaway_2">Takeaway<a class="headerlink" href="#takeaway_2" title="Permanent link">&para;</a></h3>
<p>You've learned how to:</p>
<ol>
<li>Test processes that depend on outputs from other processes</li>
<li>Verify specific genomic variants in VCF output files</li>
<li>Handle non-deterministic outputs by checking specific content</li>
<li>Test variant calling across multiple samples</li>
</ol>
<h3 id="whats-next_2">What's next?<a class="headerlink" href="#whats-next_2" title="Permanent link">&para;</a></h3>
<p>Learn how to write tests that use pre-generated test data for the joint genotyping step.</p>
<hr />
<h2 id="3-use-pre-generated-test-data">3. Use pre-generated test data<a class="headerlink" href="#3-use-pre-generated-test-data" title="Permanent link">&para;</a></h2>
<p>For the joint genotyping step, we'll use a different approach - using pre-generated test data. This is often preferable for:</p>
<ol>
<li>Complex processes with multiple dependencies</li>
<li>Processes that take a long time to run</li>
<li>Processes that are part of a stable, production pipeline</li>
</ol>
<h3 id="31-generate-test-data">3.1. Generate test data<a class="headerlink" href="#31-generate-test-data" title="Permanent link">&para;</a></h3>
<p>Let's inspect the results we generated at the start of this section:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a>tree<span class="w"> </span>results_genomics/
</code></pre></div>
<div class="highlight"><span class="filename">Results directory contents</span><pre><span></span><code><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a><span class="go">results_genomics/</span>
<a id="__codelineno-46-2" name="__codelineno-46-2" href="#__codelineno-46-2"></a><span class="go">├── family_trio.joint.vcf</span>
<a id="__codelineno-46-3" name="__codelineno-46-3" href="#__codelineno-46-3"></a><span class="go">├── family_trio.joint.vcf.idx</span>
<a id="__codelineno-46-4" name="__codelineno-46-4" href="#__codelineno-46-4"></a><span class="go">├── reads_father.bam -&gt; /workspaces/training/nf4-science/genomics/work/42/a3bf19dbfaf1f3672b16a5d5e6a8be/reads_father.bam</span>
<a id="__codelineno-46-5" name="__codelineno-46-5" href="#__codelineno-46-5"></a><span class="go">├── reads_father.bam.bai -&gt; /workspaces/training/nf4-science/genomics/work/cf/289c2d264f496d60a69e3e9ba6463e/reads_father.bam.bai</span>
<a id="__codelineno-46-6" name="__codelineno-46-6" href="#__codelineno-46-6"></a><span class="go">├── reads_father.bam.g.vcf -&gt; /workspaces/training/nf4-science/genomics/work/30/b2522b83c63baff8c3cf75704512a2/reads_father.bam.g.vcf</span>
<a id="__codelineno-46-7" name="__codelineno-46-7" href="#__codelineno-46-7"></a><span class="go">├── reads_father.bam.g.vcf.idx -&gt; /workspaces/training/nf4-science/genomics/work/30/b2522b83c63baff8c3cf75704512a2/reads_father.bam.g.vcf.idx</span>
<a id="__codelineno-46-8" name="__codelineno-46-8" href="#__codelineno-46-8"></a><span class="go">├── reads_mother.bam -&gt; /workspaces/training/nf4-science/genomics/work/af/f31a6ade82cc0cf853c4f61c8bc473/reads_mother.bam</span>
<a id="__codelineno-46-9" name="__codelineno-46-9" href="#__codelineno-46-9"></a><span class="go">├── reads_mother.bam.bai -&gt; /workspaces/training/nf4-science/genomics/work/18/89dfa40a3def17e45421e54431a126/reads_mother.bam.bai</span>
<a id="__codelineno-46-10" name="__codelineno-46-10" href="#__codelineno-46-10"></a><span class="go">├── reads_mother.bam.g.vcf -&gt; /workspaces/training/nf4-science/genomics/work/f6/be2efa58e625d08cf8d0da1d0e9f09/reads_mother.bam.g.vcf</span>
<a id="__codelineno-46-11" name="__codelineno-46-11" href="#__codelineno-46-11"></a><span class="go">├── reads_mother.bam.g.vcf.idx -&gt; /workspaces/training/nf4-science/genomics/work/f6/be2efa58e625d08cf8d0da1d0e9f09/reads_mother.bam.g.vcf.idx</span>
<a id="__codelineno-46-12" name="__codelineno-46-12" href="#__codelineno-46-12"></a><span class="go">├── reads_son.bam -&gt; /workspaces/training/nf4-science/genomics/work/9f/9615dd553d6f13d8bec4f006ac395f/reads_son.bam</span>
<a id="__codelineno-46-13" name="__codelineno-46-13" href="#__codelineno-46-13"></a><span class="go">├── reads_son.bam.bai -&gt; /workspaces/training/nf4-science/genomics/work/4d/cb384a97db5687cc9daab002017c7c/reads_son.bam.bai</span>
<a id="__codelineno-46-14" name="__codelineno-46-14" href="#__codelineno-46-14"></a><span class="go">├── reads_son.bam.g.vcf -&gt; /workspaces/training/nf4-science/genomics/work/fe/2f22d56aa16ed45f8bc419312894f6/reads_son.bam.g.vcf</span>
<a id="__codelineno-46-15" name="__codelineno-46-15" href="#__codelineno-46-15"></a><span class="go">└── reads_son.bam.g.vcf.idx -&gt; /workspaces/training/nf4-science/genomics/work/fe/2f22d56aa16ed45f8bc419312894f6/reads_son.bam.g.vcf.idx</span>
<a id="__codelineno-46-16" name="__codelineno-46-16" href="#__codelineno-46-16"></a>
<a id="__codelineno-46-17" name="__codelineno-46-17" href="#__codelineno-46-17"></a><span class="go">0 directories, 14 files</span>
</code></pre></div>
<p>Note that some of these files are symlinks to the actual files in the <code>work</code> directory.</p>
<p>The joint genotyping step needs the VCF files produced by the haplotype caller steps as inputs, along with the indices. So let's copy the results we have into the <code>jointgenotyping</code> module's test directory. We'll follow symlinks to the original files.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a>mkdir<span class="w"> </span>-p<span class="w"> </span>modules/gatk/jointgenotyping/tests/inputs/
<a id="__codelineno-47-2" name="__codelineno-47-2" href="#__codelineno-47-2"></a>cp<span class="w"> </span>-rL<span class="w"> </span>results_genomics/*.g.vcf<span class="w"> </span>results_genomics/*.g.vcf.idx<span class="w"> </span>modules/gatk/jointgenotyping/tests/inputs/
</code></pre></div>
<p>Now we can use these files as inputs to the test we're going to write for the joint genotyping step.</p>
<h3 id="32-generate-the-test-file-stub">3.2. Generate the test file stub<a class="headerlink" href="#32-generate-the-test-file-stub" title="Permanent link">&para;</a></h3>
<p>As previously, first we generate the file stub:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a>nf-test<span class="w"> </span>generate<span class="w"> </span>process<span class="w"> </span>modules/gatk/jointgenotyping/main.nf
</code></pre></div>
<p>This produces the following test stub:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">tests/modules/gatk/jointgenotyping/main.nf.test</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-49-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-49-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-49-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-49-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-49-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-49-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-49-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-49-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-49-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-49-10">10</a></span>
<span class="normal"><a href="#__codelineno-49-11">11</a></span>
<span class="normal"><a href="#__codelineno-49-12">12</a></span>
<span class="normal"><a href="#__codelineno-49-13">13</a></span>
<span class="normal"><a href="#__codelineno-49-14">14</a></span>
<span class="normal"><a href="#__codelineno-49-15">15</a></span>
<span class="normal"><a href="#__codelineno-49-16">16</a></span>
<span class="normal"><a href="#__codelineno-49-17">17</a></span>
<span class="normal"><a href="#__codelineno-49-18">18</a></span>
<span class="normal"><a href="#__codelineno-49-19">19</a></span>
<span class="normal"><a href="#__codelineno-49-20">20</a></span>
<span class="normal"><a href="#__codelineno-49-21">21</a></span>
<span class="normal"><a href="#__codelineno-49-22">22</a></span>
<span class="normal"><a href="#__codelineno-49-23">23</a></span>
<span class="normal"><a href="#__codelineno-49-24">24</a></span>
<span class="normal"><a href="#__codelineno-49-25">25</a></span>
<span class="normal"><a href="#__codelineno-49-26">26</a></span>
<span class="normal"><a href="#__codelineno-49-27">27</a></span>
<span class="normal"><a href="#__codelineno-49-28">28</a></span>
<span class="normal"><a href="#__codelineno-49-29">29</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-49-1" name="__codelineno-49-1"></a><span class="n">nextflow_process</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-49-2" name="__codelineno-49-2"></a>
<a id="__codelineno-49-3" name="__codelineno-49-3"></a><span class="w">    </span><span class="n">name</span><span class="w"> </span><span class="s2">&quot;Test Process GATK_JOINTGENOTYPING&quot;</span>
<a id="__codelineno-49-4" name="__codelineno-49-4"></a><span class="w">    </span><span class="n">script</span><span class="w"> </span><span class="s2">&quot;modules/gatk/jointgenotyping/main.nf&quot;</span>
<a id="__codelineno-49-5" name="__codelineno-49-5"></a><span class="w">    </span><span class="n">process</span><span class="w"> </span><span class="s2">&quot;GATK_JOINTGENOTYPING&quot;</span>
<a id="__codelineno-49-6" name="__codelineno-49-6"></a>
<a id="__codelineno-49-7" name="__codelineno-49-7"></a><span class="w">    </span><span class="n">test</span><span class="o">(</span><span class="s2">&quot;Should run without failures&quot;</span><span class="o">)</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-49-8" name="__codelineno-49-8"></a>
<a id="__codelineno-49-9" name="__codelineno-49-9"></a><span class="w">        </span><span class="n">when</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-49-10" name="__codelineno-49-10"></a><span class="w">            </span><span class="n">params</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-49-11" name="__codelineno-49-11"></a><span class="w">                </span><span class="c1">// define parameters here. Example:</span>
<a id="__codelineno-49-12" name="__codelineno-49-12"></a><span class="w">                </span><span class="c1">// outdir = &quot;tests/results&quot;</span>
<a id="__codelineno-49-13" name="__codelineno-49-13"></a><span class="w">            </span><span class="o">}</span>
<a id="__codelineno-49-14" name="__codelineno-49-14"></a><span class="w">            </span><span class="n">process</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-49-15" name="__codelineno-49-15"></a><span class="w">                </span><span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-49-16" name="__codelineno-49-16"></a><span class="s2">                // define inputs of the process here. Example:</span>
<a id="__codelineno-49-17" name="__codelineno-49-17"></a><span class="s2">                // input[0] = file(&quot;test-file.txt&quot;)</span>
<a id="__codelineno-49-18" name="__codelineno-49-18"></a><span class="s2">                &quot;&quot;&quot;</span>
<a id="__codelineno-49-19" name="__codelineno-49-19"></a><span class="w">            </span><span class="o">}</span>
<a id="__codelineno-49-20" name="__codelineno-49-20"></a><span class="w">        </span><span class="o">}</span>
<a id="__codelineno-49-21" name="__codelineno-49-21"></a>
<a id="__codelineno-49-22" name="__codelineno-49-22"></a><span class="w">        </span><span class="n">then</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-49-23" name="__codelineno-49-23"></a><span class="w">            </span><span class="k">assert</span><span class="w"> </span><span class="n">process</span><span class="o">.</span><span class="na">success</span>
<a id="__codelineno-49-24" name="__codelineno-49-24"></a><span class="w">            </span><span class="k">assert</span><span class="w"> </span><span class="n">snapshot</span><span class="o">(</span><span class="n">process</span><span class="o">.</span><span class="na">out</span><span class="o">).</span><span class="na">match</span><span class="o">()</span>
<a id="__codelineno-49-25" name="__codelineno-49-25"></a><span class="w">        </span><span class="o">}</span>
<a id="__codelineno-49-26" name="__codelineno-49-26"></a>
<a id="__codelineno-49-27" name="__codelineno-49-27"></a><span class="w">    </span><span class="o">}</span>
<a id="__codelineno-49-28" name="__codelineno-49-28"></a>
<a id="__codelineno-49-29" name="__codelineno-49-29"></a><span class="o">}</span>
</code></pre></div></td></tr></table></div>
<h3 id="33-move-the-test-file-and-update-the-script-path">3.3. Move the test file and update the script path<a class="headerlink" href="#33-move-the-test-file-and-update-the-script-path" title="Permanent link">&para;</a></h3>
<p>This time we already have a directory for tests co-located with the module's <code>main.nf</code> file, so we can move the test stub file there:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-50-1" name="__codelineno-50-1" href="#__codelineno-50-1"></a>mv<span class="w"> </span>tests/modules/gatk/jointgenotyping/main.nf.test<span class="w"> </span>modules/gatk/jointgenotyping/tests/
</code></pre></div>
<p>And don't forget to update the script path:</p>
<p><em>Before:</em></p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">modules/gatk/jointgenotyping/tests/main.nf.test</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-51-3">3</a></span>
<span class="normal"><a href="#__codelineno-51-4">4</a></span>
<span class="normal"><a href="#__codelineno-51-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-51-3" name="__codelineno-51-3"></a><span class="n">name</span><span class="w"> </span><span class="s2">&quot;Test Process GATK_JOINTGENOTYPING&quot;</span>
<a id="__codelineno-51-4" name="__codelineno-51-4"></a><span class="hll"><span class="n">script</span><span class="w"> </span><span class="s2">&quot;modules/gatk/jointgenotyping/main.nf&quot;</span>
</span><a id="__codelineno-51-5" name="__codelineno-51-5"></a><span class="n">process</span><span class="w"> </span><span class="s2">&quot;GATK_JOINTGENOTYPING&quot;</span>
</code></pre></div></td></tr></table></div>
<p><em>After:</em></p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">modules/gatk/jointgenotyping/tests/main.nf.test</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-52-3">3</a></span>
<span class="normal"><a href="#__codelineno-52-4">4</a></span>
<span class="normal"><a href="#__codelineno-52-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-52-3" name="__codelineno-52-3"></a><span class="n">name</span><span class="w"> </span><span class="s2">&quot;Test Process GATK_JOINTGENOTYPING&quot;</span>
<a id="__codelineno-52-4" name="__codelineno-52-4"></a><span class="hll"><span class="n">script</span><span class="w"> </span><span class="s2">&quot;../main.nf&quot;</span>
</span><a id="__codelineno-52-5" name="__codelineno-52-5"></a><span class="n">process</span><span class="w"> </span><span class="s2">&quot;GATK_JOINTGENOTYPING&quot;</span>
</code></pre></div></td></tr></table></div>
<h3 id="34-provide-inputs">3.4. Provide inputs<a class="headerlink" href="#34-provide-inputs" title="Permanent link">&para;</a></h3>
<p>Fill in the inputs based on the process input definitions and rename the test accordingly:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">modules/gatk/jointgenotyping/tests/main.nf.test</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-53-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-53-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-53-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-53-10">10</a></span>
<span class="normal"><a href="#__codelineno-53-11">11</a></span>
<span class="normal"><a href="#__codelineno-53-12">12</a></span>
<span class="normal"><a href="#__codelineno-53-13">13</a></span>
<span class="normal"><a href="#__codelineno-53-14">14</a></span>
<span class="normal"><a href="#__codelineno-53-15">15</a></span>
<span class="normal"><a href="#__codelineno-53-16">16</a></span>
<span class="normal"><a href="#__codelineno-53-17">17</a></span>
<span class="normal"><a href="#__codelineno-53-18">18</a></span>
<span class="normal"><a href="#__codelineno-53-19">19</a></span>
<span class="normal"><a href="#__codelineno-53-20">20</a></span>
<span class="normal"><a href="#__codelineno-53-21">21</a></span>
<span class="normal"><a href="#__codelineno-53-22">22</a></span>
<span class="normal"><a href="#__codelineno-53-23">23</a></span>
<span class="normal"><a href="#__codelineno-53-24">24</a></span>
<span class="normal"><a href="#__codelineno-53-25">25</a></span>
<span class="normal"><a href="#__codelineno-53-26">26</a></span>
<span class="normal"><a href="#__codelineno-53-27">27</a></span>
<span class="normal"><a href="#__codelineno-53-28">28</a></span>
<span class="normal"><a href="#__codelineno-53-29">29</a></span>
<span class="normal"><a href="#__codelineno-53-30">30</a></span>
<span class="normal"><a href="#__codelineno-53-31">31</a></span>
<span class="normal"><a href="#__codelineno-53-32">32</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-53-7" name="__codelineno-53-7"></a><span class="w">    </span><span class="n">test</span><span class="o">(</span><span class="s2">&quot;Should call trio&#39;s joint genotype correctly&quot;</span><span class="o">)</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-53-8" name="__codelineno-53-8"></a>
<a id="__codelineno-53-9" name="__codelineno-53-9"></a><span class="w">        </span><span class="n">when</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-53-10" name="__codelineno-53-10"></a><span class="w">            </span><span class="n">params</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-53-11" name="__codelineno-53-11"></a><span class="w">                </span><span class="n">outdir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;tests/results&quot;</span>
<a id="__codelineno-53-12" name="__codelineno-53-12"></a><span class="w">            </span><span class="o">}</span>
<a id="__codelineno-53-13" name="__codelineno-53-13"></a><span class="w">            </span><span class="n">process</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-53-14" name="__codelineno-53-14"></a><span class="w">                </span><span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-53-15" name="__codelineno-53-15"></a><span class="s2">                input[0] = [</span>
<a id="__codelineno-53-16" name="__codelineno-53-16"></a><span class="s2">                    file(&quot;${projectDir}/modules/gatk/jointgenotyping/tests/inputs/reads_father.bam.g.vcf&quot;),</span>
<a id="__codelineno-53-17" name="__codelineno-53-17"></a><span class="s2">                    file(&quot;${projectDir}/modules/gatk/jointgenotyping/tests/inputs/reads_mother.bam.g.vcf&quot;),</span>
<a id="__codelineno-53-18" name="__codelineno-53-18"></a><span class="s2">                    file(&quot;${projectDir}/modules/gatk/jointgenotyping/tests/inputs/reads_son.bam.g.vcf&quot;)</span>
<a id="__codelineno-53-19" name="__codelineno-53-19"></a><span class="s2">                ]</span>
<a id="__codelineno-53-20" name="__codelineno-53-20"></a><span class="s2">                input[1] = [</span>
<a id="__codelineno-53-21" name="__codelineno-53-21"></a><span class="s2">                    file(&quot;${projectDir}/modules/gatk/jointgenotyping/tests/inputs/reads_father.bam.g.vcf.idx&quot;),</span>
<a id="__codelineno-53-22" name="__codelineno-53-22"></a><span class="s2">                    file(&quot;${projectDir}/modules/gatk/jointgenotyping/tests/inputs/reads_mother.bam.g.vcf.idx&quot;),</span>
<a id="__codelineno-53-23" name="__codelineno-53-23"></a><span class="s2">                    file(&quot;${projectDir}/modules/gatk/jointgenotyping/tests/inputs/reads_son.bam.g.vcf.idx&quot;)</span>
<a id="__codelineno-53-24" name="__codelineno-53-24"></a><span class="s2">                ]</span>
<a id="__codelineno-53-25" name="__codelineno-53-25"></a><span class="s2">                input[2] = file(&quot;${projectDir}/data/ref/intervals.bed&quot;)</span>
<a id="__codelineno-53-26" name="__codelineno-53-26"></a><span class="s2">                input[3] = &quot;family_trio&quot;</span>
<a id="__codelineno-53-27" name="__codelineno-53-27"></a><span class="s2">                input[4] = file(&quot;${projectDir}/data/ref/ref.fasta&quot;)</span>
<a id="__codelineno-53-28" name="__codelineno-53-28"></a><span class="s2">                input[5] = file(&quot;${projectDir}/data/ref/ref.fasta.fai&quot;)</span>
<a id="__codelineno-53-29" name="__codelineno-53-29"></a><span class="s2">                input[6] = file(&quot;${projectDir}/data/ref/ref.dict&quot;)</span>
<a id="__codelineno-53-30" name="__codelineno-53-30"></a><span class="s2">                &quot;&quot;&quot;</span>
<a id="__codelineno-53-31" name="__codelineno-53-31"></a><span class="w">            </span><span class="o">}</span>
<a id="__codelineno-53-32" name="__codelineno-53-32"></a><span class="w">        </span><span class="o">}</span>
</code></pre></div></td></tr></table></div>
<h3 id="35-use-content-assertions">3.5. Use content assertions<a class="headerlink" href="#35-use-content-assertions" title="Permanent link">&para;</a></h3>
<p>The output of the joint genotyping step is another VCF file, so we're going to use a content assertion again.</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">modules/gatk/jointgenotyping/tests/main.nf.test</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-54-25">25</a></span>
<span class="normal"><a href="#__codelineno-54-26">26</a></span>
<span class="normal"><a href="#__codelineno-54-27">27</a></span>
<span class="normal"><a href="#__codelineno-54-28">28</a></span>
<span class="normal"><a href="#__codelineno-54-29">29</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-54-25" name="__codelineno-54-25"></a><span class="w">    </span><span class="n">then</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-54-26" name="__codelineno-54-26"></a><span class="w">        </span><span class="k">assert</span><span class="w"> </span><span class="n">process</span><span class="o">.</span><span class="na">success</span>
<a id="__codelineno-54-27" name="__codelineno-54-27"></a><span class="w">        </span><span class="k">assert</span><span class="w"> </span><span class="n">path</span><span class="o">(</span><span class="n">process</span><span class="o">.</span><span class="na">out</span><span class="o">[</span><span class="mi">0</span><span class="o">][</span><span class="mi">0</span><span class="o">]).</span><span class="na">readLines</span><span class="o">().</span><span class="na">contains</span><span class="o">(</span><span class="s1">&#39;#CHROM	POS	ID	REF	ALT	QUAL	FILTER	INFO	FORMAT	reads_father	reads_mother	reads_son&#39;</span><span class="o">)</span>
<a id="__codelineno-54-28" name="__codelineno-54-28"></a><span class="w">        </span><span class="k">assert</span><span class="w"> </span><span class="n">path</span><span class="o">(</span><span class="n">process</span><span class="o">.</span><span class="na">out</span><span class="o">[</span><span class="mi">0</span><span class="o">][</span><span class="mi">0</span><span class="o">]).</span><span class="na">readLines</span><span class="o">().</span><span class="na">contains</span><span class="o">(</span><span class="s1">&#39;20_10037292_10066351	3480	.	C	CT	1625.89	.	AC=5;AF=0.833;AN=6;BaseQRankSum=0.220;DP=85;ExcessHet=0.0000;FS=2.476;MLEAC=5;MLEAF=0.833;MQ=60.00;MQRankSum=0.00;QD=21.68;ReadPosRankSum=-1.147e+00;SOR=0.487	GT:AD:DP:GQ:PL	0/1:15,16:31:99:367,0,375	1/1:0,18:18:54:517,54,0	1/1:0,26:26:78:756,78,0&#39;</span><span class="o">)</span>
<a id="__codelineno-54-29" name="__codelineno-54-29"></a><span class="w">    </span><span class="o">}</span>
</code></pre></div></td></tr></table></div>
<p>By checking the content of a specific variant in the output file, this test verifies that:</p>
<ol>
<li>The joint genotyping process runs successfully</li>
<li>The output VCF contains all three samples in the correct order</li>
<li>A specific variant is called correctly with:</li>
<li>Accurate genotypes for each sample (0/1 for father, 1/1 for mother and son)</li>
<li>Correct read depths and genotype qualities</li>
<li>Population-level statistics like allele frequency (AF=0.833)</li>
</ol>
<p>We haven't snapshotted the whole file, but by checking a specific variant, we can be confident that the joint genotyping process is working as expected.</p>
<h3 id="36-run-the-test">3.6. Run the test<a class="headerlink" href="#36-run-the-test" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-55-1" name="__codelineno-55-1" href="#__codelineno-55-1"></a>nf-test<span class="w"> </span><span class="nb">test</span><span class="w"> </span>modules/gatk/jointgenotyping/tests/main.nf.test
</code></pre></div>
<p>This produces:</p>
<div class="highlight"><span class="filename">Output</span><pre><span></span><code><a id="__codelineno-56-1" name="__codelineno-56-1" href="#__codelineno-56-1"></a><span class="go">🚀 nf-test 0.9.2</span>
<a id="__codelineno-56-2" name="__codelineno-56-2" href="#__codelineno-56-2"></a><span class="go">https://www.nf-test.com</span>
<a id="__codelineno-56-3" name="__codelineno-56-3" href="#__codelineno-56-3"></a><span class="gp gp-VirtualEnv">(c)</span> <span class="go">2021 - 2024 Lukas Forer and Sebastian Schoenherr</span>
<a id="__codelineno-56-4" name="__codelineno-56-4" href="#__codelineno-56-4"></a>
<a id="__codelineno-56-5" name="__codelineno-56-5" href="#__codelineno-56-5"></a>
<a id="__codelineno-56-6" name="__codelineno-56-6" href="#__codelineno-56-6"></a><span class="go">Test Process GATK_JOINTGENOTYPING</span>
<a id="__codelineno-56-7" name="__codelineno-56-7" href="#__codelineno-56-7"></a>
<a id="__codelineno-56-8" name="__codelineno-56-8" href="#__codelineno-56-8"></a><span class="go">  Test [ac2067de] &#39;Should call trio&#39;s joint genotype correctly&#39; PASSED (21.604s)</span>
<a id="__codelineno-56-9" name="__codelineno-56-9" href="#__codelineno-56-9"></a>
<a id="__codelineno-56-10" name="__codelineno-56-10" href="#__codelineno-56-10"></a>
<a id="__codelineno-56-11" name="__codelineno-56-11" href="#__codelineno-56-11"></a><span class="go">SUCCESS: Executed 1 tests in 21.622s</span>
</code></pre></div>
<p>The test passes, verifying that our joint genotyping process correctly:</p>
<ol>
<li>Combines individual sample VCFs</li>
<li>Performs joint variant calling</li>
<li>Produces a multi-sample VCF with consistent genotype calls across runs</li>
</ol>
<h3 id="takeaway_3">Takeaway<a class="headerlink" href="#takeaway_3" title="Permanent link">&para;</a></h3>
<p>You know how to:</p>
<ul>
<li>Use previously generated results as inputs for tests</li>
<li>Write tests using pre-generated test data</li>
</ul>
<h3 id="whats-next_3">What's next?<a class="headerlink" href="#whats-next_3" title="Permanent link">&para;</a></h3>
<p>Add a workflow-level test to verify the entire variant calling pipeline works end-to-end.</p>
<hr />
<h2 id="4-add-a-workflow-level-test">4. Add a workflow-level test<a class="headerlink" href="#4-add-a-workflow-level-test" title="Permanent link">&para;</a></h2>
<p>Now we'll test the complete variant calling pipeline, from BAM files to joint genotypes. This verifies that:</p>
<ol>
<li>All processes work together correctly</li>
<li>Data flows properly between steps</li>
<li>Final variant calls are consistent</li>
</ol>
<h3 id="41-generate-the-workflow-test">4.1. Generate the workflow test<a class="headerlink" href="#41-generate-the-workflow-test" title="Permanent link">&para;</a></h3>
<p>Generate a test file for the complete pipeline:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-57-1" name="__codelineno-57-1" href="#__codelineno-57-1"></a>nf-test<span class="w"> </span>generate<span class="w"> </span>pipeline<span class="w"> </span>genomics-4.nf
</code></pre></div>
<p>This creates a basic test stub:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">tests/genomics-4.nf.test</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-58-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-58-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-58-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-58-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-58-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-58-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-58-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-58-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-58-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-58-10">10</a></span>
<span class="normal"><a href="#__codelineno-58-11">11</a></span>
<span class="normal"><a href="#__codelineno-58-12">12</a></span>
<span class="normal"><a href="#__codelineno-58-13">13</a></span>
<span class="normal"><a href="#__codelineno-58-14">14</a></span>
<span class="normal"><a href="#__codelineno-58-15">15</a></span>
<span class="normal"><a href="#__codelineno-58-16">16</a></span>
<span class="normal"><a href="#__codelineno-58-17">17</a></span>
<span class="normal"><a href="#__codelineno-58-18">18</a></span>
<span class="normal"><a href="#__codelineno-58-19">19</a></span>
<span class="normal"><a href="#__codelineno-58-20">20</a></span>
<span class="normal"><a href="#__codelineno-58-21">21</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-58-1" name="__codelineno-58-1"></a><span class="n">nextflow_pipeline</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-58-2" name="__codelineno-58-2"></a>
<a id="__codelineno-58-3" name="__codelineno-58-3"></a><span class="w">    </span><span class="n">name</span><span class="w"> </span><span class="s2">&quot;Test Workflow genomics-4.nf&quot;</span>
<a id="__codelineno-58-4" name="__codelineno-58-4"></a><span class="w">    </span><span class="n">script</span><span class="w"> </span><span class="s2">&quot;genomics-4.nf&quot;</span>
<a id="__codelineno-58-5" name="__codelineno-58-5"></a>
<a id="__codelineno-58-6" name="__codelineno-58-6"></a><span class="w">    </span><span class="n">test</span><span class="o">(</span><span class="s2">&quot;Should run without failures&quot;</span><span class="o">)</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-58-7" name="__codelineno-58-7"></a>
<a id="__codelineno-58-8" name="__codelineno-58-8"></a><span class="w">        </span><span class="n">when</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-58-9" name="__codelineno-58-9"></a><span class="w">            </span><span class="n">params</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-58-10" name="__codelineno-58-10"></a><span class="w">                </span><span class="c1">// define parameters here. Example:</span>
<a id="__codelineno-58-11" name="__codelineno-58-11"></a><span class="w">                </span><span class="c1">// outdir = &quot;tests/results&quot;</span>
<a id="__codelineno-58-12" name="__codelineno-58-12"></a><span class="w">            </span><span class="o">}</span>
<a id="__codelineno-58-13" name="__codelineno-58-13"></a><span class="w">        </span><span class="o">}</span>
<a id="__codelineno-58-14" name="__codelineno-58-14"></a>
<a id="__codelineno-58-15" name="__codelineno-58-15"></a><span class="w">        </span><span class="n">then</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-58-16" name="__codelineno-58-16"></a><span class="w">            </span><span class="k">assert</span><span class="w"> </span><span class="n">workflow</span><span class="o">.</span><span class="na">success</span>
<a id="__codelineno-58-17" name="__codelineno-58-17"></a><span class="w">        </span><span class="o">}</span>
<a id="__codelineno-58-18" name="__codelineno-58-18"></a>
<a id="__codelineno-58-19" name="__codelineno-58-19"></a><span class="w">    </span><span class="o">}</span>
<a id="__codelineno-58-20" name="__codelineno-58-20"></a>
<a id="__codelineno-58-21" name="__codelineno-58-21"></a><span class="o">}</span>
</code></pre></div></td></tr></table></div>
<p>Just correct the name to something meaningful (you'll see why this is useful shortly).</p>
<p><em>Before:</em></p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">tests/genomics-4.nf.test</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-59-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-59-1" name="__codelineno-59-1"></a><span class="hll"><span class="w">    </span><span class="n">test</span><span class="o">(</span><span class="s2">&quot;Should run without failures&quot;</span><span class="o">)</span><span class="w"> </span><span class="o">{</span>
</span></code></pre></div></td></tr></table></div>
<p><em>After:</em></p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">tests/genomics-4.nf.test</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-60-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-60-1" name="__codelineno-60-1"></a><span class="hll"><span class="w">    </span><span class="n">test</span><span class="o">(</span><span class="s2">&quot;Should run the pipeline without failures&quot;</span><span class="o">)</span><span class="w"> </span><span class="o">{</span>
</span></code></pre></div></td></tr></table></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In this case the test file can stay where <code>nf-test</code> created it.</p>
</div>
<h3 id="42-specify-input-parameters">4.2. Specify input parameters<a class="headerlink" href="#42-specify-input-parameters" title="Permanent link">&para;</a></h3>
<p>We still need to specify inputs, which is done slightly different at the workflow level compared to module-level tests.
There are several ways of doing this, including by specifying a profile.
However, a simpler way is to set up a <code>params {}</code> block in the <code>nextflow.config</code> file that <code>nf-test init</code> originally created in the <code>tests</code> directory.</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">tests/nextflow.config</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-61-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-61-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-61-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-61-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-61-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-61-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-61-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-61-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-61-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-61-10">10</a></span>
<span class="normal"><a href="#__codelineno-61-11">11</a></span>
<span class="normal"><a href="#__codelineno-61-12">12</a></span>
<span class="normal"><a href="#__codelineno-61-13">13</a></span>
<span class="normal"><a href="#__codelineno-61-14">14</a></span>
<span class="normal"><a href="#__codelineno-61-15">15</a></span>
<span class="normal"><a href="#__codelineno-61-16">16</a></span>
<span class="normal"><a href="#__codelineno-61-17">17</a></span>
<span class="normal"><a href="#__codelineno-61-18">18</a></span>
<span class="normal"><a href="#__codelineno-61-19">19</a></span>
<span class="normal"><a href="#__codelineno-61-20">20</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-61-1" name="__codelineno-61-1"></a><span class="cm">/*</span>
<a id="__codelineno-61-2" name="__codelineno-61-2"></a><span class="cm"> * Pipeline parameters</span>
<a id="__codelineno-61-3" name="__codelineno-61-3"></a><span class="cm"> */</span>
<a id="__codelineno-61-4" name="__codelineno-61-4"></a>
<a id="__codelineno-61-5" name="__codelineno-61-5"></a><span class="n">params</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-61-6" name="__codelineno-61-6"></a><span class="w">    </span><span class="c1">// Primary input (file of input files, one per line)</span>
<a id="__codelineno-61-7" name="__codelineno-61-7"></a><span class="w">    </span><span class="n">reads_bam</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;${projectDir}/data/sample_bams.txt&quot;</span>
<a id="__codelineno-61-8" name="__codelineno-61-8"></a>
<a id="__codelineno-61-9" name="__codelineno-61-9"></a><span class="w">    </span><span class="c1">// Output directory</span>
<a id="__codelineno-61-10" name="__codelineno-61-10"></a><span class="w">    </span><span class="n">outdir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;results_genomics&quot;</span>
<a id="__codelineno-61-11" name="__codelineno-61-11"></a>
<a id="__codelineno-61-12" name="__codelineno-61-12"></a><span class="w">    </span><span class="c1">// Reference genome and intervals</span>
<a id="__codelineno-61-13" name="__codelineno-61-13"></a><span class="w">    </span><span class="n">reference</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;${projectDir}/data/ref/ref.fasta&quot;</span>
<a id="__codelineno-61-14" name="__codelineno-61-14"></a><span class="w">    </span><span class="n">reference_index</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;${projectDir}/data/ref/ref.fasta.fai&quot;</span>
<a id="__codelineno-61-15" name="__codelineno-61-15"></a><span class="w">    </span><span class="n">reference_dict</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;${projectDir}/data/ref/ref.dict&quot;</span>
<a id="__codelineno-61-16" name="__codelineno-61-16"></a><span class="w">    </span><span class="n">intervals</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;${projectDir}/data/ref/intervals.bed&quot;</span>
<a id="__codelineno-61-17" name="__codelineno-61-17"></a>
<a id="__codelineno-61-18" name="__codelineno-61-18"></a><span class="w">    </span><span class="c1">// Base name for final output file</span>
<a id="__codelineno-61-19" name="__codelineno-61-19"></a><span class="w">    </span><span class="n">cohort_name</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;family_trio&quot;</span>
<a id="__codelineno-61-20" name="__codelineno-61-20"></a><span class="o">}</span>
</code></pre></div></td></tr></table></div>
<p>When we run the test, <code>nf-test</code> will pick up this configuration file and pull in the inputs accordingly.</p>
<h3 id="43-run-the-workflow-test">4.3. Run the workflow test<a class="headerlink" href="#43-run-the-workflow-test" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-62-1" name="__codelineno-62-1" href="#__codelineno-62-1"></a>nf-test<span class="w"> </span><span class="nb">test</span><span class="w"> </span>tests/genomics-4.nf.test
</code></pre></div>
<p>This produces:</p>
<div class="highlight"><span class="filename">Output</span><pre><span></span><code><a id="__codelineno-63-1" name="__codelineno-63-1" href="#__codelineno-63-1"></a><span class="go">🚀 nf-test 0.9.2</span>
<a id="__codelineno-63-2" name="__codelineno-63-2" href="#__codelineno-63-2"></a><span class="go">https://www.nf-test.com</span>
<a id="__codelineno-63-3" name="__codelineno-63-3" href="#__codelineno-63-3"></a><span class="gp gp-VirtualEnv">(c)</span> <span class="go">2021 - 2024 Lukas Forer and Sebastian Schoenherr</span>
<a id="__codelineno-63-4" name="__codelineno-63-4" href="#__codelineno-63-4"></a>
<a id="__codelineno-63-5" name="__codelineno-63-5" href="#__codelineno-63-5"></a>
<a id="__codelineno-63-6" name="__codelineno-63-6" href="#__codelineno-63-6"></a><span class="go">Test Workflow genomics-4.nf</span>
<a id="__codelineno-63-7" name="__codelineno-63-7" href="#__codelineno-63-7"></a>
<a id="__codelineno-63-8" name="__codelineno-63-8" href="#__codelineno-63-8"></a><span class="go">  Test [c7dbcaca] &#39;Should run without failures&#39; PASSED (48.443s)</span>
<a id="__codelineno-63-9" name="__codelineno-63-9" href="#__codelineno-63-9"></a>
<a id="__codelineno-63-10" name="__codelineno-63-10" href="#__codelineno-63-10"></a>
<a id="__codelineno-63-11" name="__codelineno-63-11" href="#__codelineno-63-11"></a><span class="go">SUCCESS: Executed 1 tests in 48.486s</span>
</code></pre></div>
<p>The test passes, confirming that our complete variant calling pipeline:</p>
<ol>
<li>Successfully processes all samples</li>
<li>Correctly chains together all steps</li>
</ol>
<h3 id="44-run-all-tests">4.4. Run ALL tests<a class="headerlink" href="#44-run-all-tests" title="Permanent link">&para;</a></h3>
<p>nf-test has one more trick up it's sleeve. We can run all the tests at once! Modify the <code>nf-test.config</code> file so that nf-test looks in every directory for nf-test files. You can do this by modifying the <code>testsDir</code> parameter:</p>
<p><em>Before:</em></p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">nf-test.config</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-64-1">1</a></span>
<span class="normal"><a href="#__codelineno-64-2">2</a></span>
<span class="normal"><a href="#__codelineno-64-3">3</a></span>
<span class="normal"><a href="#__codelineno-64-4">4</a></span>
<span class="normal"><a href="#__codelineno-64-5">5</a></span>
<span class="normal"><a href="#__codelineno-64-6">6</a></span>
<span class="normal"><a href="#__codelineno-64-7">7</a></span>
<span class="normal"><a href="#__codelineno-64-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-64-1" name="__codelineno-64-1"></a><span class="n">config</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-64-2" name="__codelineno-64-2"></a>
<a id="__codelineno-64-3" name="__codelineno-64-3"></a><span class="hll"><span class="w">    </span><span class="n">testsDir</span><span class="w"> </span><span class="s2">&quot;tests&quot;</span>
</span><a id="__codelineno-64-4" name="__codelineno-64-4"></a><span class="w">    </span><span class="n">workDir</span><span class="w"> </span><span class="s2">&quot;.nf-test&quot;</span>
<a id="__codelineno-64-5" name="__codelineno-64-5"></a><span class="w">    </span><span class="n">configFile</span><span class="w"> </span><span class="s2">&quot;tests/nextflow.config&quot;</span>
<a id="__codelineno-64-6" name="__codelineno-64-6"></a><span class="w">    </span><span class="n">profile</span><span class="w"> </span><span class="s2">&quot;&quot;</span>
<a id="__codelineno-64-7" name="__codelineno-64-7"></a>
<a id="__codelineno-64-8" name="__codelineno-64-8"></a><span class="o">}</span>
</code></pre></div></td></tr></table></div>
<p><em>After:</em></p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">nf-test.config</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-65-1">1</a></span>
<span class="normal"><a href="#__codelineno-65-2">2</a></span>
<span class="normal"><a href="#__codelineno-65-3">3</a></span>
<span class="normal"><a href="#__codelineno-65-4">4</a></span>
<span class="normal"><a href="#__codelineno-65-5">5</a></span>
<span class="normal"><a href="#__codelineno-65-6">6</a></span>
<span class="normal"><a href="#__codelineno-65-7">7</a></span>
<span class="normal"><a href="#__codelineno-65-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-65-1" name="__codelineno-65-1"></a><span class="n">config</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-65-2" name="__codelineno-65-2"></a>
<a id="__codelineno-65-3" name="__codelineno-65-3"></a><span class="hll"><span class="w">    </span><span class="n">testsDir</span><span class="w"> </span><span class="s2">&quot;.&quot;</span>
</span><a id="__codelineno-65-4" name="__codelineno-65-4"></a><span class="w">    </span><span class="n">workDir</span><span class="w"> </span><span class="s2">&quot;.nf-test&quot;</span>
<a id="__codelineno-65-5" name="__codelineno-65-5"></a><span class="w">    </span><span class="n">configFile</span><span class="w"> </span><span class="s2">&quot;tests/nextflow.config&quot;</span>
<a id="__codelineno-65-6" name="__codelineno-65-6"></a><span class="w">    </span><span class="n">profile</span><span class="w"> </span><span class="s2">&quot;&quot;</span>
<a id="__codelineno-65-7" name="__codelineno-65-7"></a>
<a id="__codelineno-65-8" name="__codelineno-65-8"></a><span class="o">}</span>
</code></pre></div></td></tr></table></div>
<p>Now, we can simply run nf-test and it will run <em>every single test</em> in our repository:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-66-1" name="__codelineno-66-1" href="#__codelineno-66-1"></a>nf-test<span class="w"> </span><span class="nb">test</span>
</code></pre></div>
<p>This produces:</p>
<div class="highlight"><span class="filename">Output</span><pre><span></span><code><a id="__codelineno-67-1" name="__codelineno-67-1" href="#__codelineno-67-1"></a><span class="go">🚀 nf-test 0.9.2</span>
<a id="__codelineno-67-2" name="__codelineno-67-2" href="#__codelineno-67-2"></a><span class="go">https://www.nf-test.com</span>
<a id="__codelineno-67-3" name="__codelineno-67-3" href="#__codelineno-67-3"></a><span class="gp gp-VirtualEnv">(c)</span> <span class="go">2021 - 2024 Lukas Forer and Sebastian Schoenherr</span>
<a id="__codelineno-67-4" name="__codelineno-67-4" href="#__codelineno-67-4"></a>
<a id="__codelineno-67-5" name="__codelineno-67-5" href="#__codelineno-67-5"></a>
<a id="__codelineno-67-6" name="__codelineno-67-6" href="#__codelineno-67-6"></a><span class="go">Test Process GATK_HAPLOTYPECALLER</span>
<a id="__codelineno-67-7" name="__codelineno-67-7" href="#__codelineno-67-7"></a>
<a id="__codelineno-67-8" name="__codelineno-67-8" href="#__codelineno-67-8"></a><span class="go">  Test [c847bfae] &#39;Should call son&#39;s haplotype correctly&#39; PASSED (20.951s)</span>
<a id="__codelineno-67-9" name="__codelineno-67-9" href="#__codelineno-67-9"></a><span class="go">  Test [44494e9c] &#39;Should call mother&#39;s haplotype correctly&#39; PASSED (19.155s)</span>
<a id="__codelineno-67-10" name="__codelineno-67-10" href="#__codelineno-67-10"></a><span class="go">  Test [eb0d1a07] &#39;Should call father&#39;s haplotype correctly&#39; PASSED (21.843s)</span>
<a id="__codelineno-67-11" name="__codelineno-67-11" href="#__codelineno-67-11"></a>
<a id="__codelineno-67-12" name="__codelineno-67-12" href="#__codelineno-67-12"></a><span class="go">Test Process GATK_JOINTGENOTYPING</span>
<a id="__codelineno-67-13" name="__codelineno-67-13" href="#__codelineno-67-13"></a>
<a id="__codelineno-67-14" name="__codelineno-67-14" href="#__codelineno-67-14"></a><span class="go">  Test [ac2067de] &#39;Should call trio&#39;s joint genotype correctly&#39; PASSED (22.994s)</span>
<a id="__codelineno-67-15" name="__codelineno-67-15" href="#__codelineno-67-15"></a>
<a id="__codelineno-67-16" name="__codelineno-67-16" href="#__codelineno-67-16"></a><span class="go">Test Process SAMTOOLS_INDEX</span>
<a id="__codelineno-67-17" name="__codelineno-67-17" href="#__codelineno-67-17"></a>
<a id="__codelineno-67-18" name="__codelineno-67-18" href="#__codelineno-67-18"></a><span class="go">  Test [625e39ee] &#39;Should index reads_son.bam correctly&#39; PASSED (11.281s)</span>
<a id="__codelineno-67-19" name="__codelineno-67-19" href="#__codelineno-67-19"></a><span class="go">  Test [a8b28f36] &#39;Should index reads_mother.bam correctly&#39; PASSED (11.126s)</span>
<a id="__codelineno-67-20" name="__codelineno-67-20" href="#__codelineno-67-20"></a><span class="go">  Test [c15852a1] &#39;Should index reads_father.bam correctly&#39; PASSED (12.005s)</span>
<a id="__codelineno-67-21" name="__codelineno-67-21" href="#__codelineno-67-21"></a>
<a id="__codelineno-67-22" name="__codelineno-67-22" href="#__codelineno-67-22"></a><span class="go">Test Workflow genomics-4.nf</span>
<a id="__codelineno-67-23" name="__codelineno-67-23" href="#__codelineno-67-23"></a>
<a id="__codelineno-67-24" name="__codelineno-67-24" href="#__codelineno-67-24"></a><span class="go">  Test [c7dbcaca] &#39;Should run the pipeline without failures&#39; PASSED (47.92s)</span>
<a id="__codelineno-67-25" name="__codelineno-67-25" href="#__codelineno-67-25"></a>
<a id="__codelineno-67-26" name="__codelineno-67-26" href="#__codelineno-67-26"></a>
<a id="__codelineno-67-27" name="__codelineno-67-27" href="#__codelineno-67-27"></a><span class="go">SUCCESS: Executed 8 tests in 167.772s</span>
</code></pre></div>
<p>7 tests in 1 command! We spent a long time configuring lots and lots of tests, but when it came to running them it was very quick and easy. You can see how useful this is when maintaining a large pipeline, which could include hundreds of different elements. We spend time writing tests once so we can save time running them many times.</p>
<p>Furthermore, we can automate this! Imagine tests running every time you or a colleague tries to add new code. This is how we ensure our pipelines maintain a high standard.</p>
<h2 id="takeaway_4">Takeaway<a class="headerlink" href="#takeaway_4" title="Permanent link">&para;</a></h2>
<p>You now know how to write and run several kinds of tests for your genomics pipeline using nf-test. This testing framework helps ensure your variant calling workflow produces consistent, reliable results across different environments and as you make code changes.</p>
<p>You've learned to test critical components like:</p>
<ul>
<li>The <code>SAMTOOLS_INDEX</code> process that prepares BAM files for variant calling</li>
<li>The <code>GATK_HAPLOTYPECALLER</code> process that identifies variants in individual samples</li>
<li>The <code>GATK_JOINTGENOTYPING</code> process that combines variant calls across a cohort</li>
</ul>
<p>You've also implemented different testing strategies specific to genomics data:</p>
<ul>
<li>Verifying that VCF files contain expected variant calls despite non-deterministic elements like timestamps</li>
<li>Testing with a family trio dataset to ensure proper variant identification across related samples</li>
<li>Checking for specific genomic coordinates and variant information in your output files</li>
</ul>
<p>These testing skills are essential for developing robust bioinformatics pipelines that can reliably process genomic data and produce accurate variant calls. As you continue working with Nextflow for genomics analysis, this testing foundation will help you maintain high-quality code that produces trustworthy scientific results.</p>









  




                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  맨위로
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="하단/푸터" >
        
          
          <a href="../03_modules/" class="md-footer__link md-footer__link--prev" aria-label="이전: Part 3: Moving code into modules">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                이전
              </span>
              <div class="md-ellipsis">
                Part 3: Moving code into modules
              </div>
            </div>
          </a>
        
        
          
          <a href="../survey/" class="md-footer__link md-footer__link--next" aria-label="다음: Feedback survey">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                다음
              </span>
              <div class="md-ellipsis">
                Feedback survey
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  <div>
    Copyright &copy; 2020-2025,
    <a href="https://seqera.io" target="_blank" rel="noopener">Seqera</a>.
  </div>
  <div class="footer_cc_link">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512">
      <!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.-->
      <path
        d="m245.83 214.87-33.22 17.28c-9.43-19.58-25.24-19.93-27.46-19.93-22.13 0-33.22 14.61-33.22 43.84 0 23.57 9.21 43.84 33.22 43.84 14.47 0 24.65-7.09 30.57-21.26l30.55 15.5c-6.17 11.51-25.69 38.98-65.1 38.98-22.6 0-73.96-10.32-73.96-77.05 0-58.69 43-77.06 72.63-77.06 30.72-.01 52.7 11.95 65.99 35.86zm143.05 0-32.78 17.28c-9.5-19.77-25.72-19.93-27.9-19.93-22.14 0-33.22 14.61-33.22 43.84 0 23.55 9.23 43.84 33.22 43.84 14.45 0 24.65-7.09 30.54-21.26l31 15.5c-2.1 3.75-21.39 38.98-65.09 38.98-22.69 0-73.96-9.87-73.96-77.05 0-58.67 42.97-77.06 72.63-77.06 30.71-.01 52.58 11.95 65.56 35.86zM247.56 8.05C104.74 8.05 0 123.11 0 256.05c0 138.49 113.6 248 247.56 248 129.93 0 248.44-100.87 248.44-248 0-137.87-106.62-248-248.44-248zm.87 450.81c-112.54 0-203.7-93.04-203.7-202.81 0-105.42 85.43-203.27 203.72-203.27 112.53 0 202.82 89.46 202.82 203.26-.01 121.69-99.68 202.82-202.84 202.82z"
      ></path>
    </svg>
    <a
      href="https://creativecommons.org/licenses/by-nc-nd/4.0/"
      target="_blank"
      rel="noopener"
      title="Creative Commons CC BY-NC-ND 4.0"
    >
      Creative Commons BY-NC-ND 4.0</a
    >.
  </div>
   Made with
  <a
    href="https://squidfunk.github.io/mkdocs-material/"
    target="_blank"
    rel="noopener"
  >
    Material for MkDocs
  </a>
  
</div>
      
        <div class="md-social">
  <a
    href="https://seqera.io"
    target="_blank"
    rel="noopener"
    class="footer_seqera_logo"
  >
    <img src="/assets/img/seqera_logo_white.png" />
  </a>
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            


  


<h4>Cookie consent</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our training materials better.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
    
      
        
  
  
    
    
  
  <li class="task-list-item">
    <label class="task-list-control">
      <input type="checkbox" name="analytics" checked>
      <span class="task-list-indicator"></span>
      Google Analytics
    </label>
  </li>

      
    
    
      
        
  
  
    
    
  
  <li class="task-list-item">
    <label class="task-list-control">
      <input type="checkbox" name="github" checked>
      <span class="task-list-indicator"></span>
      GitHub
    </label>
  </li>

      
    
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">동의 허락</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">동의 허락 관리</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script>
    
    
      
      <script id="__config" type="application/json">{"base": "../../../..", "features": ["content.action.edit", "content.code.annotate", "content.code.copy", "navigation.footer", "navigation.instant", "navigation.top", "navigation.tracking", "search.share", "toc.follow"], "search": "../../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "\ud074\ub9bd\ubcf4\ub4dc\uc5d0 \ubcf5\uc0ac\ub428", "clipboard.copy": "\ud074\ub9bd\ubcf4\ub4dc\ub85c \ubcf5\uc0ac", "search.result.more.one": "\uc774 \ubb38\uc11c\uc5d0\uc11c 1\uac1c\uc758 \uac80\uc0c9 \uacb0\uacfc \ub354 \ubcf4\uae30", "search.result.more.other": "\uc774 \ubb38\uc11c\uc5d0\uc11c #\uac1c\uc758 \uac80\uc0c9 \uacb0\uacfc \ub354 \ubcf4\uae30", "search.result.none": "\uac80\uc0c9\uc5b4\uc640 \uc77c\uce58\ud558\ub294 \ubb38\uc11c\uac00 \uc5c6\uc2b5\ub2c8\ub2e4", "search.result.one": "1\uac1c\uc758 \uc77c\uce58\ud558\ub294 \ubb38\uc11c", "search.result.other": "#\uac1c\uc758 \uc77c\uce58\ud558\ub294 \ubb38\uc11c", "search.result.placeholder": "\uac80\uc0c9\uc5b4\ub97c \uc785\ub825\ud558\uc138\uc694", "search.result.term.missing": "\ud3ec\ud568\ub418\uc9c0 \uc54a\uc740 \uac80\uc0c9\uc5b4", "select.version": "\ubc84\uc804 \uc120\ud0dd"}, "version": {"alias": true, "provider": "mike"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
    
  </body>
</html>